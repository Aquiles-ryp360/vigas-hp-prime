#pragma mode(separator(.,;)integer(h64))ini_pgrm();
VIEW "VigaPRO v2",START()BEGIN startview(6,1);
ini_pgrm;
END;
MOUSE1();
MOUSE2();
mouse_apy();
mouse_frz();
inim_pgrm();
opn_datvp();
dataVP_L:={0,0,0,0,0,0,0,0,0,0};
dataVP_C:={"NAME_DOC",20};
tlcd1:={"1","2","3",4,5,6,7,8,9,0,"Q","W","E","R","T","Y","U","I","O","P","A","S","D","F","G","H","J","K","L","Ñ","Z","X","C","V","B","N","M","_"};
tlcd2:={"1","2","3",4,5,6,7,8,9,0,"q","w","e","r","t","y","u","i","o","p","a","s","d","f","g","h","j","k","l","ñ","z","x","c","v","b","n","m","_"};
carg_punt:="3699A56B3688E13AB183B2F5F35D2CF57CFB95686AD66C5311EC14F4E514BA11B972F32150E62FAC85B69AEA87177E0C2BCE857330CF8D369C12772F3728A5093812AA2F45C23884288B080EF0AAEA3FE01B51721618B177A087C6061FE4FD330CBABB3A2D3B0757C5F96850FA9E8EF69AF5E04376F3AB63972CB04026B4C3A78BA2EA806CF04C4276BA1C5029A6FFF80223D9E0B3A219B8794BEF4CB2E7C911D0DE9AF1CC96B0430031B5423CC180F7D7C62E9A7BD5BA8710DF1A58382143C122C6022502E5A863362C8A37DA23EEA41F38CF0BDEFF001F76843703D23B706B337CB8A6EDE54FC727545F1E4CE69AA97035C1DC7DFA64B1B5CE2059AC81C4569FC18462315BE60D6537A45E268ECB3DD2CBC345709E2E7C4B0CD4DFCF27A011893789F810641432EE618B289877D404BE24E899F54417CEFAABABD43772A57FA23F899BC78B8E4D5E40483F7850DB9B0B39F10E6D367D7B1EDE6A82886094CDB035C2DBC50B90FEC0571E8FAE185F573257CF0FA0FCB80C6DB6D6FA60CD0F6AB05D9B8DD5B749F2C9A558579E28C2ADECD1535A6AAC66E4DC5FB268F625992D70517B4E40E38CD5E2F1802C5C67B20EF6101DC35CB2000D878DE7E59EB342890BF40DA9A43FEBEDBE426903D4F5A9957762E56475E02185F54C27CEE381AA1C2A8A843B18B7D43CE8B857B76C24B81D040BC44B8B409170BE1143664F6D0CF8A6745F61C8C1C5BBC7B7BCBD6BFA170269C2564B97B6756149E35E2872A8FF71E768EEC4B986816C91BA8E8B4CB11C63952AD85B2AF20FF904BAE60B006214EBA44E610F3DD6B1D3A02D3DA5E218E7C03BA0370E0F41F5BD2B04375C2ED04E3E8006D6A26C2C07E9D11B6BB2AEEB3CF092096A4564ED55533C8DC306D4D160E8DBE8178126692B23239DBB23EFEFFF6AA284B765585E6AC950F1CC6FDBC9F6F3A67FE7390CF57A936092A18504CA5BBEF3EAB4F4545DC206C33676F7A9263100808F16CF77794744FDCDA3DA9F37057F5620F7062EF5CF3EE385E2850DCF3582568A4493A828A9E4DFC5E9511E38299E6BDFE0B21339F2780DDD05525963BE219770F4CDB5542D817E7B07E8190A4A59FB3A3A6B669E1C5062064D25C14E23AC4112F982075BA9C6A96BD55904FE0453C9C0B66EC8DD6751FDABD87F9FA403637E3CF5E1C255D4DD3A74E7712BEC58E3189F9C40A2F2B2456D0AB20521490FE70C4C9C98E7EB12EA55CCDC0B032709DED0C0497BE49DA11A68C39511EA1CC4F41DC49C30AF05EB7B5C14F062DC0368F94A175652C7AB07C17E924DF008379DF86D901A7A9F8FB2165C60453B7D3DA008AA7885DA196A385B848609BAA05B88C4950A5DCF7A79FBB9BRIALSECB434AA53BF7847A09813425D7AC236501BF25B10A56F625E1EF89A07C54934311ED2E503BC5A30539562CCC7D183341A6312B1DF6EEC22B82E33E15A2B72771E2BB1C8C900BA5C0C752E36661C25062E8E46DFE346E026F64BFEB09DFD0ESIALR1E9BB3E29BF7B28BE9F23822C86B53A7710277043A7148EBAA904105FE1C2A87A4C834204BF053ED84065A2504113F4D18070CC28E5C5C91FDFCCB56294764FED086FE40F821F66543C1EB714CB00D49C3201DC846F733A5B0477F5LAIRES87AE8A6E8BE022AEF663CF69B0507425B2C79C3BE68A0A2CFC7AD7955B39AD85C12C98637502D757E16031E7418B17890820D823E567C584589C5DA2949968A7B4B60E992982A3296895FF7B754BC620FDC88C8395E6D2A4DAE18C1BF1F3AEFABBF4399E230DC3B4042F60621E19BB70CCDB10340196E7E335BF2F3EA76178C51895F1F50027B8A66D34227E1CAD4C00A9F3AF528882D48C0B23BC9C229EDF1E805271B227113C68F7C15D9550E508D3C1E02785793C06B7CE0C9AB46CE78171BEDDDDB1937B9C9493FA11F753A73B1FB7732E5C242B9AF8AD1363988C9608EC6BA453F7A7795004B9DC7F4657A5EB856AFD094278558CDE02295507164CDC73A225772B4020B0F7089849E1A47854AEF65E1EF5B33404108BEF3C8591382098A441A1E2530E90C341D0043F5D7EA4012812261BD30EB2A4DEC94DE93AF7E6BFEADE1DD45A0BC069530965555F21E4F0E2ABC9C8F83C341B70B5B2F59CD9C62D5395ED15D4C1DB63759D5CBB19BD26A21571789A9F52BECE2B789A18F100AA07A3D4659743D447B8A104A47D66AF5258CFB1D437F20087C7C0B17676E9BD7406F42EAD7053B762E2DDA3D0E6EC758D4F88158799731FF8E8E8D9BB0FA8762087A58F828E06864E6A465B6CA0CE9EA7C7A2A0A1C151D35201E1487B00EE15D0F994B79A860867D1C99EDBBAE8374B2D1F5BDA8C971D770077DFB19A9A342CCB530431CE2AF1240FEE2FDD4D84F045B6D8129576435BA8671DC5128BED5C48F84F871D21D98CF97CFC8D7CC1529183B1A145BD283793E9C6838031514935820EF0B05F740B6F6A600389F9DD8EFEFF401EF3BFCFA82E32CE41355130529A77DB19A1183E0338E7A5EFEFCF3BFBFA60DF9C5ECAD3EAE229E220897ABE9561DC5AF05B7636E11467A183689F8D211CEDA0B038B4E849A1FA032AC013A3F127B6ACF9725E5DBEEC60595AEC5E43B4806DD587D98FA88E0065AE636189FE081937E07DAE2472DBE328FAF5F30FA278F9168863C274C2783B1ED72D2BF1778FC47C6CB4384AFD49390E6FC846F3F65ED0D1658776322E895C8764B9108625045BC102B14126D8E5B2337F85CE8928F28BA9C9207D2B71461E9A3E16C6626BA6F5DCAC4C3CE0331CDD944902A50EBC650D8D3B65C84941CA9FA15E287A6E90E4F7E88E587AFD82D825795005E97B4436BBF320C30E8A0188169DF7CF5187E22CA2A2CF5006F09E382A25";

carg_ines:="4E514BA11B972F32150E62FAC85B69AEA87177E0C2BCE857330C3699A56B3688E13AB183B2F5F35D2CF57CFB95686AD66C5311EC14FF8D369C12772F3728A5093812AA2F45C23884288B080EF0AAEA3FE01B51721618B177A087C6061FE4FD330CBABB3A2D3B0757C5F96850FA9E8EF69AF5E04376F3AB63972CB04026B4C3A78BA2EA806CF04C4276BA1C5029A6FFF80223D9E0B3A219B8794BEF4CB2E7C911D0DE9AF1CC96B0430031B5423CC180F7D7C62E9A7BD5BA8710DF1A58382143C122C6022502E5A863362C8A37DA23EEA41F38CF0BDEFF001F76843703D23B706B337CB8A6EDE54FC727545F1E4CE69AA97035C1DC7DFA64B1B5CE2059AC81C4569FC18462315BE60D6537A45E268ECB3DD2CBC345709E2E7C4B0CD4DFCF27A011893789F810641432EE618B289877D404BE24E899F54417CEFAABABD43772A57FA23F899BC78B8E4D5E40483F7850DB9B0B39F10E6D367D7B1EDE6A82886094CDB035C2DBC50B90FEC0571E8FAE185F573257CF0FA0FCB80C6DB6D6FA60CD0F6AB05D9B8DD5B749F2C9A558579E28C2ADECD1535A6AAC66E4DC5FB268F625992D70517B4E40E38CD5E2F1802C5C67B20EF6101DC35CB2000D878DE7E59EB342890BF40DA9A43FEBEDBE426903D4F5A9957762E56475E02185F54C27CEE381AA1C2A8A843B18B7D43CE8B857B76C24B81D040BC44B8B409170BE1143664F6D0CF8A6745F61C8C1C5BBC7B7BCBD6BFA170269C2564B97B6756149E35E2872A8FF71E768EEC4B986816C91BA8E8B4CB11C63952AD85B2AF20FF904BAE60B006214EBA44E610F3DD6B1D3A02D3DA5E218E7C03BA0370E0F41F5BD2B04375C2ED04E3E8006D6A26C2C07E9D11B6BB2AEEB3CF092096A4564ED55533C8DC306D4D160E8DBE8178126692B23239DBB23EFEFFF6AA284B765585E6AC950F1CC6FDBC9F6F3A67FE7390CF57A936092A18504CA5BBEF3EAB4F4545DC206C33676F7A9263100808F16CF77794744FDCDA3DA9F37057F5620F7062EF5CF3EE385E2850DCF3582568A4493A828A9E4DFC5E9511E38299E6BDFE0B21339F2780DDD05525963BE219770F4CDB5542D817E7B07E8190A4A59FB3A3A6B669E1C5062064D25C14E23AC4112F982075BA9C6A96BD55904FE0453C9C0B66EC8DD6751FDABD87F9FA403637E3CF5E1C255D4DD3A74E7712BEC58E3189F9C40A2F2B2456D0AB20521490FE70C4C9C98E7EB12EA55CCDC0B032709DED0C0497BE49DA11A68C39511EA1CC4F41DC49C30AF05EB7B5C14F062DC0368F94A175652C7AB07C17E924DF008379DF86D901A7A9F8FB2165C60453B7D3DA008AA7885DA196A385B848609BAA05B88C4950A5DCF7A79FBB9BRIALSECB434AA53BF7847A09813425D7AC236501BF25B10A56F625E1EF89A07C54934311ED2E503BC5A30539562CCC7D183341A6312B1DF6EEC22B82E33E15A2B72771E2BB1C8C900BA5C0C752E36661C25062E8E46DFE346E026F64BFEB09DFD0ESIALR1E9BB3E29BF7B28BE9F23822C86B53A7710277043A7148EBAA904105FE1C2A87A4C834204BF053ED84065A2504113F4D18070CC28E5C5C91FDFCCB56294764FED086FE40F821F66543C1EB714CB00D49C3201DC846F733A5B0477F5LAIRES87AE8A6E8BE022AEF663CF69B0507425B2C79C3BE68A0A2CFC7AD7955B39AD85C12C98637502D757E16031E7418B17890820D823E567C584589C5DA2949968A7B4B60E992982A3296895FF7B754BC620FDC88C8395E6D2A4DAE18C1BF1F3AEFABBF4399E230DC3B4042F60621E19BB70CCDB10340196E7E335BF2F3EA76178C51895F1F50027B8A66D34227E1CAD4C00A9F3AF528882D48C0B23BC9C229EDF1E805271B227113C68F7C15D9550E508D3C1E02785793C06B7CE0C9AB46CE78171BEDDDDB1937B9C9493FA11F753A73B1FB7732E5C242B9AF8AD1363988C9608EC6BA453F7A7795004B9DC7F4657A5EB856AFD094278558CDE02295507164CDC73A225772B4020B0F7089849E1A47854AEF65E1EF5B33404108BEF3C85913CD62509CY30E90C341D0043F5D7EA4012812261BD30EB2A4DEC94DE93AF7E6BFEADE1DD45A0BC069530965555F21E4F0E2ABC9C8F83C341B70B5B2F59CD9C62D5395ED15D4C1DB63759D5CBB19BD26A21571789A9F52BECE2B789A18F100AA07A3D4659743D447B8A104A47D66AF5258CFB1D437F20087C7C0B17676E9BD7406F42EAD7053B762E2DDA3D0E6EC758D4F88158799731FF8E8E8D9BB0FA8762087A58F828E06864E6A465B6CA0CE9EA7C7A2A0A1C151D35201E1487B00EE15D0F994B79A860867D1C99EDBBAE8374B2D1F5BDA8C971D770077DFB19A9A342CCB530431CE2AF1240FEE2FDD4D84F045B6D8129576435BA8671DC5128BED5C48F84F871D21D98CF97CFC8D7CC1529183B1A145BD283793E9C6838031514935820EF0B05F740B6F6A600389F9DD8EFEFF401EF3BFCFA82E32CE41355130529A77DB19A1183E0338E7A5EFEFCF3BFBFA60DF9C5ECAD3EAE229E220897ABE9561DC5AF05B7636E11467A183689F8D211CEDA0B038B4E849A1FA032AC013A3F127B6ACF9725E5DBEEC60595AEC5E43B4806DD587D98FA88E0065AE636189FE081937E07DAE2472DBE328FAF5F30FA278F9168863C274C2783B1ED72D2BF1778FC47C6CB4384AFD49390E6FC846F3F65ED0D1658776322E895C8764B91086261E9A3E16C6626BA6F5DCAC4C3CE0331CDD944902A50EBC650D8D3B65C84941CA9FA15E287A6E90E4F7E88E587AFD82D825795005E97B4436BBF320C30E8A0188169DF7CF5187E22CA2A2CF5006F09E382A255045BC102B14126D8E5B2337F85CE8928F28BA9C9207D2B714";

mon_fl:="9A56B3688E13AB183B2F5F35D2CF57CFB95686AD66C5311EC14FF8D4E514BA11B972F32150E62FAC85B69AEA87177E0C2BCE857330C369369C12772F3728A5093812AA2F45C23884288B080EF0AAEA3FE01B51721618B177A087C6061FE4FD330CBABB3A2D3B0757C5F96850FA9E8EF69AF5E04376F3AB63972CB04026B4C3A78BA2EA806CF04C4276BA1C5029A6FFF80223D9E0B3A219B8794BEF4CB2E7C911D0DE9AF1CC96B0430031B5423CC180F7D7C62E9A7BD5BA8710DF1A58382143C122C6022502E5A863362C8A37DA23EEA41F38CF0BDEFF001F76843703D23B706B337CB8A6EDE54FC727545F1E4CE69AA97035C1DC7DFA64B1B5CE2059AC81C4569FC18462315BE60D6537A45E268ECB3DD2CBC345709E2E7C4B0CD4DFCF27A011893789F810641432EE618B289877D404BE24E899F54417CEFAABABD43772A57FA23F899BC78B8E4D5E40483F7850DB9B0B39F10E6D367D7B1EDE6A82886094CDB035C2DBC50B90FEC0571E8FAE185F573257CF0FA0FCB80C6DB6D6FA60CD0F6AB05D9B8DD5B749F2C9A558579E28C2ADECD1535A6AAC66E4DC5FB268F625992D70517B4E40E38CD5E2F1802C5C67B20EF6101DC35CB2000D878DE7E59EB342890BF40DA9A43FEBEDBE426903D4F5A9957762E56475E02185F54C27CEE381AA1C2A8A843B18B7D43CE8B857B76C24B81D040BC44B8B409170BE1143664F6D0CF8A6745F61C8C1C5BBC7B7BCBD6BFA170269C2564B97B6756149E35E2872A8FF71E768EEC4B986816C91BA8E8B4CB11C63952AD85B2AF20FF904BAE60B006214EBA44E610F3DD6B1D3A02D3DA5E218E7C03BA0370E0F41F5BD2B04375C2ED04E3E8006D6A26C2C07E9D11B6BB2AEEB3CF092096A4564ED55533C8DC306D4D160E8DBE8178126692B23239DBB23EFEFFF6AA284B765585E6AC950F1CC6FDBC9F6F3A67FE7390CF57A936092A18504CA5BBEF3EAB4F4545DC206C33676F7A9263100808F16CF77794744FDCDA3DA9F37057F5620F7062EF5CF3EE385E2850DCF3582568A4493A828A9E4DFC5E9511E38299E6BDFE0B21339F2780DDD05525963BE219770F4CDB5542D817E7B07E8190A4A59FB3A3A6B669E1C5062064D25C14E23AC4112F982075BA9C6A96BD55904FE0453C9C0B66EC8DD6751FDABD87F9FA403637E3CF5E1C255D4DD3A74E7712BEC58E3189F9C40A2F2B2456D0AB20521490FE70C4C9C98E7EB12EA55CCDC0B032709DED0C0497BE49DA11A68C39511EA1CC4F41DC49C30AF05EB7B5C14F062DC0368F94A175652C7AB07C17E924DF008379DF86D901A7A9F8FB2165C60453B7D3DA008AA7885DA196A385B848609BAA05B88C4950A5DCF7A79FBB9BRIALSECB434AA53BF7847A09813425D7AC236501BF25B10A56F625E1EF89A07C54934311ED2E503BC5A30539562CCC7D183341A6312B1DF6EEC22B82E33E15A2B72771E2BB1C8C900BA5C0C752E36661C25062E8E46DFE346E026F64BFEB09DFD0ESIALR1E9BB3E29BF7B28BE9F23822C86B53A7710277043A7148EBAA904105FE1C2A87A4C834204BF053ED84065A2504113F4D18070CC28E5C5C91FDFCCB56294764FED086FE40F821F66543C1EB714CB00D49C3201DC846F733A5B0477F5LAIRES87AE8A6E8BE022AEF663CF69B0507425B2C79C3BE68A0A2CFC7AD7955B39AD85C12C98637502D757E16031E7418B17890820D823E567C584589C5DA2949968A7B4B60E992982A3296895FF7B754BC620FDC88C8395E6D2A4DAE18C1BF1F3AEFABBF4399E230DC3B4042F60621E19BB70CCDB10340196E7E335BF2F3EA76178C51895F1F50027B8A66D34227E1CAD4C00A9F3AF528882D48C0B23BC9C229EDF1E805271B227113C68F7C15D9550E508D3C1E02785793C06B7CE0C9AB46CE78171BEDDDDB1937B9C9493FA11F753A73B1FB7732E5C242B9AF8AD1363988C9608EC6BA453F7A7795004B9DC7F4657A5EB856AFD094278558CDE02295507164CDC73A225772B4020B0F7089849E1A47854AEF65E1EF5B33404108BEF3C8591382098A441A1E2530E90C341D0043F5D7EA4012812261BD30EB2A4DEC94DE93AF7E6BFEADE1DD45A0BC069530965555F21E4F0E2ABC9C8F83C341B70B5B2F59CD9C62D5395ED15D4C1DB63759D5CBB19BD26A21571789A9F52BECE2B789A18F100AA07A3D4659743D447B8A104A47D66AF5258CFB1D437F20087C7C0B17676E9BD7406F42EAD7053B762E2DDA3D0E6EC758D4F88158799731FF8E8E8D9BB0FA8762087A58F828E06864E6A465B6CA0CE9EA7C7A2A0A1C151D35201E1487B00EE15D0F994B79A860867D1C99EDBBAE8374B2D1F5BDA8C971D770077DFB19A9A342CCB530431CE2AF1240FEE2FDD4D84F045B6D8129576435BA8671DC5128BED5C48F84F871D21D98CF97CFC8D7CC1529183B1A145BD283793E9C6838031514935820EF0B05F740B6F6A600389F9DD8EFEFF401EF3BFCFA82E32CE41355130529A77DB19A1183E0338E7A5EFEFCF3BFBFA60DF9C5ECAD3EAE229E220897ABE9561DC5AF05B7636E11467A183689F8D211CEDA0B038B4E849A1FA032AC013A3F127B6ACF9725E5DBEEC60595AEC5E43B4806DD587D98FA88E0065AE636189FE081937E07DAE2472DBE328FAF5F30FA278F9168863C274C2783B1ED72D2BF1778FC47C6CB4384AFD49390E6FC846F3F65ED0D1658776322E895C8764B91086261E9A3E16C6626BA6F5DCAC4C3CE0331CDD944902A50EBC650D8D3B65C849416F09E382A255045BC102B14126D8E5B2337F85CE8928F28BA9C9207D2B714CA9FA15E287A6E90E4F7E88E587AFD82D825795005E97B4436BBF320C30E8A0188169DF7CF5187E22CA2A2CF500";
Coor,k;
elem_gnrt:=2.5;

ns_in:=10;
mayus:=0;
Tcls_pg:=25;
report();
mouse3();
time_dat();
bt_fuerza();
SELECT_apy();
SELECT_fuerza();
dat_inp();
apyo_in();
may_tlc();
VIGAP();
diag_gen();
ejecut();
com_nd();
TQ(Punto1,Punto2)BEGIN Punto1(1)≤Coor(2)≤Punto2(1)AND Punto1(2)≤Coor(3)≤Punto2(2)END;
#pragma mode(integer(h64))ini_pgrm BEGIN dataVP(28):=HAngle;
HAngle:=0;
G4:=AFiles("openINI.jpg");
for k from 1 to 10 do RECT_P(0,0,320,240,{#000000,0+25*k});
wait(0.1);
BLIT(G4);
end;
RECT_P(G4,40,150,120,180,#848484,{#1C1C1C,70});
RECT_P(G4,120,150,200,180,#848484,{#1C1C1C,70});
RECT_P(G4,200,150,280,180,#848484,{#1C1C1C,70});
TEXTOUT_P("New",G4,65,155,4,#FFFFFF);
TEXTOUT_P("About",G4,139,155,4,#FFFFFF);
TEXTOUT_P("Exit",G4,227,155,4,#FFFFFF);
If DIM(fileVP(1))=1 then fileVP(1):="NAME_DOC1";
end;
If DIM(fileVP(2))=1 then fileVP(2):="NAME_DOC2";
end;
If DIM(fileVP(3))=1 then fileVP(3):="NAME_DOC3";
end;
If DIM(fileVP(4))=1 then fileVP(4):="NAME_DOC4";
end;
If DIM(fileVP(5))=1 then fileVP(5):="NAME_DOC5";
end;
BLIT(G4);
inim_pgrm();
END;
VIGAP BEGIN G1:=AFiles("INIg.png");
G3:=AFiles("Fileas.png");
LINE_P(G1,0,21,320,21,#000000);
TEXTOUT_P("VigaPRO",G1,138,5,2,#FFFFFF);
textout_p("┊",G1,2,25,1,#A4A4A4);
textout_p("┊",G1,2,38,1,#A4A4A4);
line_p(G1,35,23,35,48,#BDBDBD);
line_p(G1,65,23,65,48,#BDBDBD);
line_p(G1,95,23,95,48,#BDBDBD);
line_p(G1,125,23,125,48,#BDBDBD);
line_p(G1,155,23,155,48,#BDBDBD);
line_p(G1,185,23,185,48,#BDBDBD);
line_p(G1,0,50,320,50,#A4A4A4);
line_p(G1,5,220,5,238,#0040FF);
line_p(G1,2,235,20,235,#086A87);
textout_p("ｚ",G1,4,218,1,#0040FF);
textout_p("x",G1,15,226,1,#086A87);
textout_p("◢",G1,234,17,7,#1C1C1C);
textout_p("◣",G1,243,17,7,#1C1C1C);
textout_p("—",G1,235,22,6,#1C1C1C);
textout_p("°°°",G1,236,34,3,#1C1C1C);
textout_p("______",G1,233,32,1,#1C1C1C);
textout_p("′′′′′′′′′′′",G1,234,42,1,#1C1C1C);
textout_p("▂▂",G1,265,25,4,#1C1C1C);
line_p(G1,267,26,267,40,#1C1C1C);
line_p(G1,272,27,272,40,#1C1C1C);
line_p(G1,277,28,277,40,#1C1C1C);
line_p(G1,282,30,282,40,#1C1C1C);
line_p(G1,267,25,282,30,#1C1C1C);
textout_p("↓↓↓↓",G1,265,29,1,#1C1C1C);
pixon_p(G1,282,29,#E6E6E6);
textout_p("E",G1,291,22,7,#1C1C1C);
textout_p("E",G1,292,22,7,#1C1C1C);
textout_p("E",G1,291,21,7,#1C1C1C);
textout_p("E",G1,292,21,7,#1C1C1C);
textout_p("Ｉ",G1,299,22,7,#1C1C1C);
textout_p("Ｉ",G1,300,22,7,#1C1C1C);
textout_p("Ｉ",G1,299,21,7,#1C1C1C);
textout_p("Ｉ",G1,300,21,7,#1C1C1C);
time_dat;
END;
inim_pgrm()BEGIN LOCAL ejecc;
REPEAT Coor:=WAIT(-1);
IF TYPE(Coor)THEN LOCAL Tipo=Coor(1),k;
IF Tipo=3 THEN IF TQ({40,150},{120,180})THEN ejecc:=1;
RECT_P(40,150,120,180,#E6E6E6);
TEXTOUT_P("New",65,155,4,#1C1C1C);
wait(0.5);
BLIT(G4);
RECT_P(0,0,320,240,0,{#1C1C1C,50});
RECT_P(70,80,250,160,0,{#F2F2F2,100});
textout_p("New Beam Creation",10,5,4,#00A8FB);
textout_p("Enter total length of the Beam",90,85,1,#1C1C1C);
textout_p("L = ",95,100,3,0);
RECT_P(125,100,195,115,#1C1C1C,#FFFFFF);
RECT_P(150,135,190,155,#1C1C1C,#1C1C1C);
RECT_P(200,135,240,155,#1C1C1C,#1C1C1C);
textout_p("Canc",155,137,3,#FFFFFF);
textout_p("Ok",210,137,3,#FFFFFF);
dataVP_L(1):=0;
textout_p(dataVP_L(1),128,102,2,#1C1C1C);
END;
IF TQ({120,150},{200,180})THEN ejecc:=2;
RECT_P(120,150,200,180,#E6E6E6);
TEXTOUT_P("About",139,155,4,#1C1C1C);
wait(0.5);
G0:=AFiles("openINI.jpg");
RECT_P(20,20,300,220,0,{#FFFFFF,50});
TEXTOUT_P("Content",22,25,4,#088A85);
TEXTOUT_P("Results",22,45,2,#0080FF);
TEXTOUT_P("You can get:",22,65,1,#1C1C1C);
TEXTOUT_P("- Reactions in supports",22,75,1,#1C1C1C);
TEXTOUT_P("- Values of those functions at any point of the beam",22,85,1,#1C1C1C);
TEXTOUT_P("- Graphic representations",22,95,1,#1C1C1C);
TEXTOUT_P("- Maximum values in the functions",22,105,1,#1C1C1C);
TEXTOUT_P("- For the hyperstatic beams, the matrix of functions that is ",22,115,1,#1C1C1C);
TEXTOUT_P(" obtained when calculating the supports' reactions.",22,125,1,#1C1C1C);
TEXTOUT_P("- You can save and open data.",22,135,1,#1C1C1C);
TEXTOUT_P("Advance of the next version",22,155,2,#0080FF);
TEXTOUT_P("- Sample of the rigidez matrices of each bar",22,175,1,#0080FF);
TEXTOUT_P("- It will also allow you to sort the results in a report in ",22,185,1,#0080FF);
TEXTOUT_P(" the form of a web page",22,195,1,#0080FF);
TEXTOUT_P("- Interaction of result and transfer to spreadsheet",22,205,1,#0080FF);
TEXTOUT_P("Hebert PV 2019",22,225,1,#FFFFFF);
TEXTOUT_P("X",279,22,6,0);
END;
IF ejecc=2 THEN IF TQ({260,20},{300,60})THEN BLIT(G4);
ejecc:=0;
END;
END;
IF ejecc=1 THEN IF TQ({125,100},{195,115})THEN apyo_in();
dat_inp(1,125,100,195,115);
END;
IF TQ({150,135},{190,155})THEN RECT_P(150,135,190,155,0,#0080FF);
textout_p("Canc",155,137,3,#FFFFFF);
wait(0.5);
BLIT(G4);
ejecc:=0;
END;
IF TQ({200,135},{240,155})THEN RECT_P(200,135,240,155,0,#0080FF);
textout_p("Ok",210,137,3,#FFFFFF);
wait(0.5);
VIGAP;
dataVP(21):=1;
dataVP(22):=1;
dataVP(23):=0;
dataVP(24):=0;
dataVP(25):=0;
dataVP(27):=0;
dataVP(1):=dataVP_L(1);
dataVP(15):={0,dataVP(1)};
dataVP(15):=SORT(dataVP(15));
dataVP(16):=[[0,1,1,1],[dataVP(1),1,1,1]];
dataVP(17):=[[0,0,0,0],[dataVP(1),0,0,0]];
dataVP(18):=[[1,0,1]];
dataVP(19):=[[0,dataVP(1),0,0]];
LOCAL N,lista_nod,mat_apoyo,dN,nod,k;
LOCAL lon;
lista_nod:=dataVP(15);
M5:=dataVP(16);
A:=dataVP(1);
N:=MAKEMAT(0,SIZE(lista_nod),2);
mat_apoyo:=MAKEMAT(0,rowDim(N),2);
FOR k FROM 1 TO rowDim(N)DO N(k,1):=lista_nod(k);
mat_apoyo(k,1):=lista_nod(k);
END;
dN:=MAKEMAT(1,rowDim(N),3);
FOR k FROM 1 TO rowDim(M5)DO FOR nod FROM 1 TO rowDim(N)DO IF M5(k,1)=lista_nod(nod)THEN dN(nod,1):=M5(k,2);
dN(nod,2):=M5(k,3);
dN(nod,3):=M5(k,4);
END;
END;
END;
FOR k FROM 1 TO rowDim(N)DO IF dN(k,1)=0 AND dN(k,2)=0 AND dN(k,3)=0 THEN mat_apoyo(k,2):=0;
END;
IF dN(k,1)=0 AND dN(k,2)=0 AND dN(k,3)=1 THEN mat_apoyo(k,2):=1;
END;
IF dN(k,1)=1 AND dN(k,2)=0 AND dN(k,3)=1 THEN mat_apoyo(k,2):=2;
END;
IF dN(k,1)=1 AND dN(k,2)=1 AND dN(k,3)=1 THEN mat_apoyo(k,2):=3;
END;
IF dN(k,1)=1 AND dN(k,2)=1 AND dN(k,3)=0 THEN mat_apoyo(k,2):=4;
END;
END;
lon:=MAKEMAT(0,rowDim(N)-1,1);
for k from 1 to rowDim(N)-1 do lon(k,1):=N(k+1,1)-N(k,1);
end;
RECT_P(G1,0,52,320,240,#FFFFFF);
line_p(G1,30,129,290,129,#2E2E2E);
line_p(G1,30,130,290,130,#2E2E2E);
line_p(G1,30,131,290,131,#2E2E2E);
line_p(G1,30,221,290,221,#848484);
line_p(G1,30,235,290,235,#04B4AE);
if A<=50 then for k from 1 to A do line_p(G1,30+k*(260/A),233,30+k*(260/A),237,#04B4AE);
end;
end;
for k from 1 to rowDim(mat_apoyo)do line_p(G1,30+mat_apoyo(k,1)*(260/A),216,30+mat_apoyo(k,1)*(260/A),225,#848484);
line_p(G1,26+mat_apoyo(k,1)*(260/A),218,34+mat_apoyo(k,1)*(260/A),223,#848484);
textout_p(mat_apoyo(k,1),G1,26+mat_apoyo(k,1)*(260/A),231,1,0,100,#FFFFFF);
end;
for k from 1 to rowDim(mat_apoyo)-1 do textout_p(lon(k,1),G1,25+(mat_apoyo(k,1)+(lon(k,1)/2))*(260/A),223,1,#848484);
end;
BLIT(G1);
MOUSE1();
END;
END;
IF TQ({200,150},{280,180})THEN RECT_P(200,150,280,180,#E6E6E6);
TEXTOUT_P("Exit",227,155,4,#1C1C1C);
wait(0.5);
for k from 1 to 10 do BLIT(G4);
RECT_P(0,0,320,240,{#000000,250-25*k});
wait(0.1);
end;
HAngle:=dataVP(28);
com_nd();
END;
END;
END;
UNTIL 0;
END;
MOUSE1()BEGIN REPEAT time_dat;
BLIT(G1);
Coor:=WAIT(-1);
IF TYPE(Coor)THEN LOCAL Tipo=Coor(1),k;
IF Tipo=0 THEN for k from 1 to 5 do ARC_P(Coor(2),Coor(3),4*k,0,2*π,{#A9D0F5,#A9D0F5});
WAIT(0.05);
end;
END;
IF Tipo=3 THEN IF TQ({5,21},{34,49})THEN DIMGROB_P(G2,320,240);
RECT(G2);
RECT_P(G2,0,0,320,240,#FFFFFF);
RECT_P(G2,0,0,120,240,#FFFFFF);
LINE_P(G2,121,10,121,230,#D8D8D8);
BLIT_P(G2,0,0,120,240,G3,0,0,120,240);
textout_p("⇦",G2,1,-6,7,#1C1C1C);
TEXTOUT_P("VigaPRO",G2,25,6,1,#1C1C1C);
textout_p("New",G2,35,32,1,#1C1C1C);
textout_p("Open",G2,35,62,1,#1C1C1C);
textout_p("Save",G2,35,92,1,#1C1C1C);
textout_p("Save As",G2,35,122,1,#1C1C1C);
textout_p("Export",G2,35,152,1,#1C1C1C);
textout_p("Exit",G2,35,182,1,#1C1C1C);
textout_p("Version 1.20.3",G2,5,210,1,#A4A4A4);
textout_p("Powered by Hebert PV",G2,5,220,1,#A4A4A4);
textout_p("IDEAS HP PRIME",G2,5,230,1,#A4A4A4);
dataVP(12):=0;
BLIT(G2);
MOUSE2();
END;
IF TQ({230,21},{259,50})THEN SELECT_apy;
END;
IF TQ({260,21},{289,50})THEN SELECT_fuerza;
END;
IF TQ({290,21},{320,50})THEN M0:=dataVP(18);
M0:=EDITMAT(M0,{"PROPIEDADES DE BARRA",{"1"},{"Elasticity","Area","Inercia",""}});
dataVP(18):=M0;
BLIT(G1);
MOUSE1();
END;
IF TQ({65,23},{95,48})THEN if dataVP(27)=0 then RECT_P(0,22,320,240,0,{#1C1C1C,100});
RECT_P(60,80,270,150,0,#1C1C1C);
TEXTOUT_P("Please first save the ",120,100,2,#FFFFFF);
TEXTOUT_P("data in the files option",120,113,2,#FFFFFF);
TEXTOUT_P("!",100,100,7,#FF0000);
wait(2);
BLIT(G1);
MOUSE1();
else BLIT(G1);
RECT_P(0,22,320,240,{#1C1C1C,100});
RECT_P(60,80,270,150,0,#1C1C1C);
TEXTOUT_P(dataVP_C(1),120,90,2,#FF00FF);
TEXTOUT_P("SAVING DATA",130,105,2,#FFFFFF);
RECT_P(90,123,240,125,0);
for k:=1 to 30 do RECT_P(90,123,90+5*k,125,#40FF00);
wait(0.02);
end;
IF dataVP(27)=1 THEN fileVP(1):=dataVP_C(1);
fileVP(6):=dataVP(27);
fileVP(11):=dataVP(1);
fileVP(16):=dataVP(15);
fileVP(21):=dataVP(16);
fileVP(26):=dataVP(17);
fileVP(31):=dataVP(18);
fileVP(36):=dataVP(19);
END;
IF dataVP(27)=2 THEN fileVP(2):=dataVP_C(1);
fileVP(7):=dataVP(27);
fileVP(12):=dataVP(1);
fileVP(17):=dataVP(15);
fileVP(22):=dataVP(16);
fileVP(27):=dataVP(17);
fileVP(32):=dataVP(18);
fileVP(37):=dataVP(19);
END;
IF dataVP(27)=3 THEN fileVP(3):=dataVP_C(1);
fileVP(8):=dataVP(27);
fileVP(13):=dataVP(1);
fileVP(18):=dataVP(15);
fileVP(23):=dataVP(16);
fileVP(28):=dataVP(17);
fileVP(33):=dataVP(18);
fileVP(38):=dataVP(19);
END;
IF dataVP(27)=4 THEN fileVP(4):=dataVP_C(1);
fileVP(9):=dataVP(27);
fileVP(14):=dataVP(1);
fileVP(19):=dataVP(15);
fileVP(24):=dataVP(16);
fileVP(29):=dataVP(17);
fileVP(34):=dataVP(18);
fileVP(39):=dataVP(19);
END;
IF dataVP(27)=5 THEN fileVP(5):=dataVP_C(1);
fileVP(10):=dataVP(27);
fileVP(15):=dataVP(1);
fileVP(20):=dataVP(15);
fileVP(25):=dataVP(16);
fileVP(30):=dataVP(17);
fileVP(35):=dataVP(18);
fileVP(40):=dataVP(19);
END;
RECT_P(60,80,270,150,0,#1C1C1C);
TEXTOUT_P("successfully saved",130,100,2,#FFFFFF);
TEXTOUT_P(dataVP_C(1),130,113,2,#FF00FF);
TEXTOUT_P("✔",100,100,7,#40FF00);
wait(1.5);
BLIT(G1);
MOUSE1();
end;
END;
IF TQ({95,23},{125,48})THEN RECT_P(0,22,320,240);
RECT_P(0,22,320,50,#2E2E2E);
textout_p("RESULTS",10,25,4,#FFFFFF);
textout_p("RESULTS",11,25,4,#FFFFFF);
textout_p("BEAN FIGURE",10,60,1,#0174DF);
textout_p("Support",10,85,1,#2E2E2E);
textout_p("Forces",10,105,1,#2E2E2E);
rect_p(75,80,90,95,#2E2E2E,#FFFFFF);
rect_p(75,100,90,115,#2E2E2E,#FFFFFF);
DRAWMENU("Cancel","","","","","Ok");
textout_p("INTERNAL FORCE",117,60,1,#0174DF);
textout_p("R (Reaction)",117,85,1,#2E2E2E);
textout_p("V (Shear)",117,105,1,#2E2E2E);
textout_p("M (Moment)",117,125,1,#2E2E2E);
rect_p(177,80,192,95,#2E2E2E,#FFFFFF);
rect_p(177,100,192,115,#2E2E2E,#FFFFFF);
rect_p(177,120,192,135,#2E2E2E,#FFFFFF);
textout_p("DEFLECTIONS",224,60,1,#0174DF);
textout_p("φ (Rotation)",224,85,1,#2E2E2E);
textout_p("δz (Vertical)",224,105,1,#2E2E2E);
textout_p("δx (Horiz.)",224,125,1,#2E2E2E);
rect_p(284,80,299,95,#2E2E2E,#FFFFFF);
rect_p(284,100,299,115,#2E2E2E,#FFFFFF);
rect_p(284,120,299,135,#2E2E2E,#FFFFFF);
IF dataVP(21)=1 THEN rect_p(75,80,90,95,#2E2E2E,#FFFFFF);
textout_p("✔",77,80,3,#FF0000);
END;
IF dataVP(22)=1 THEN rect_p(75,100,90,115,#2E2E2E,#FFFFFF);
textout_p("✔",77,100,3,#FF0000);
END;
IF dataVP(23)=1 THEN rect_p(177,80,192,95,#2E2E2E,#FFFFFF);
textout_p("✔",179,80,3,#FF0000);
END;
IF dataVP(24)=1 THEN rect_p(177,100,192,115,#2E2E2E,#FFFFFF);
textout_p("✔",179,100,3,#FF0000);
END;
IF dataVP(25)=1 THEN rect_p(177,120,192,135,#2E2E2E,#FFFFFF);
textout_p("✔",179,120,3,#FF0000);
END;
report()END;
END;
END;
UNTIL 0;
END;
report()BEGIN REPEAT time_dat;
Coor:=WAIT(-1);
IF TYPE(Coor)THEN LOCAL Tipo=Coor(1),k;
IF Tipo=3 THEN IF TQ({75,80},{90,95})THEN dataVP(21):=dataVP(21)+1;
if dataVP(21)=2 then dataVP(21):=0;
end;
if dataVP(21)=0 then rect_p(75,80,90,95,#2E2E2E,#FFFFFF);
end;
if dataVP(21)=1 then rect_p(75,80,90,95,#2E2E2E,#FFFFFF);
textout_p("✔",77,80,3,#FF0000);
end;
END;
IF TQ({75,100},{90,115})THEN dataVP(22):=dataVP(22)+1;
if dataVP(22)=2 then dataVP(22):=0;
end;
if dataVP(22)=0 then rect_p(75,100,90,115,#2E2E2E,#FFFFFF);
end;
if dataVP(22)=1 then rect_p(75,100,90,115,#2E2E2E,#FFFFFF);
textout_p("✔",77,100,3,#FF0000);
end;
END;
IF TQ({177,80},{192,95})THEN dataVP(23):=dataVP(23)+1;
if dataVP(23)=2 then dataVP(23):=0;
end;
if dataVP(23)=0 then rect_p(177,80,192,95,#2E2E2E,#FFFFFF);
end;
if dataVP(23)=1 then rect_p(177,80,192,95,#2E2E2E,#FFFFFF);
textout_p("✔",179,80,3,#FF0000);
end;
END;
IF TQ({177,100},{192,115})THEN dataVP(24):=dataVP(24)+1;
if dataVP(24)=2 then dataVP(24):=0;
end;
if dataVP(24)=0 then rect_p(177,100,192,115,#2E2E2E,#FFFFFF);
end;
if dataVP(24)=1 then rect_p(177,100,192,115,#2E2E2E,#FFFFFF);
textout_p("✔",179,100,3,#FF0000);
end;
END;
IF TQ({177,120},{192,135})THEN dataVP(25):=dataVP(25)+1;
if dataVP(25)=2 then dataVP(25):=0;
end;
if dataVP(25)=0 then rect_p(177,120,192,135,#2E2E2E,#FFFFFF);
end;
if dataVP(25)=1 then rect_p(177,120,192,135,#2E2E2E,#FFFFFF);
textout_p("✔",179,120,3,#FF0000);
end;
END;
IF TQ({266,220},{320,240})THEN if dataVP(21)=0 and dataVP(22)=0 and dataVP(23)=0 and dataVP(24)=0 and dataVP(25)=0 then dataVP(21):=1;
dataVP(22):=1;
end;
ejecut();
BLIT(G1);
MOUSE1();
END;
IF TQ({1,220},{51,240})THEN BLIT(G1);
MOUSE1();
END;
END;
END;
UNTIL 0;
END;
MOUSE2()BEGIN REPEAT time_dat;
Coor:=WAIT(-1);
IF TYPE(Coor)THEN LOCAL Tipo=Coor(1),k;
IF Tipo=3 THEN IF TQ({0,21},{120,50})THEN dataVP(12):=1;
BLIT(G2);
RECT_P(0,21,2,50,#00A8FB);
textout_p("New",35,32,1,#00A8FB);
textout_p("New Beam Creation",130,15,4,#00A8FB);
textout_p("Enter total length of the Beam",130,40,2,#1C1C1C);
textout_p("L = ",155,70,3,#1C1C1C);
RECT_P(180,70,250,85,#1C1C1C,#FFFFFF);
RECT_P(280,65,310,90,#1C1C1C,#1C1C1C);
textout_p("Ok",286,70,3,#FFFFFF);
dataVP_L(1):=0;
textout_p(dataVP_L(1),183,72,2,#1C1C1C);
END;
IF TQ({0,51},{120,80})THEN dataVP(12):=2;
BLIT(G2);
RECT_P(0,51,2,80,#00A8FB);
textout_p("Open",35,62,1,#00A8FB);
textout_p("OPEN",130,15,4,#1C1C1C);
textout_p("Stored Files",180,15,4,#00A8FB);
textout_p(fileVP(1)+".vp",165,50,2,#00A8FB);
textout_p(fileVP(2)+".vp",165,90,2,#00A8FB);
textout_p(fileVP(3)+".vp",165,130,2,#00A8FB);
textout_p(fileVP(4)+".vp",165,170,2,#00A8FB);
textout_p(fileVP(5)+".vp",165,210,2,#00A8FB);
BLIT_P(G0,135,40,165,70,G3,130,53,160,83);
BLIT_P(G0,135,80,165,110,G3,130,53,160,83);
BLIT_P(G0,135,120,165,150,G3,130,53,160,83);
BLIT_P(G0,135,160,165,190,G3,130,53,160,83);
BLIT_P(G0,135,200,165,230,G3,130,53,160,83);
END;
IF TQ({0,81},{120,110})THEN dataVP(12):=3;
BLIT(G2);
RECT_P(0,81,2,110,#00A8FB);
textout_p("Save",35,92,1,#00A8FB);
textout_p("SAVE",130,15,4,#1C1C1C);
textout_p("Files",170,15,4,#00A8FB);
textout_p(fileVP(1)+".vp",165,50,2,#00A8FB);
textout_p(fileVP(2)+".vp",165,90,2,#00A8FB);
textout_p(fileVP(3)+".vp",165,130,2,#00A8FB);
textout_p(fileVP(4)+".vp",165,170,2,#00A8FB);
textout_p(fileVP(5)+".vp",165,210,2,#00A8FB);
BLIT_P(G0,135,40,165,70,G3,130,23,160,53);
BLIT_P(G0,135,80,165,110,G3,130,23,160,53);
BLIT_P(G0,135,120,165,150,G3,130,23,160,53);
BLIT_P(G0,135,160,165,190,G3,130,23,160,53);
BLIT_P(G0,135,200,165,230,G3,130,23,160,53);
END;
IF TQ({0,111},{120,140})THEN dataVP(12):=4;
BLIT(G2);
RECT_P(0,111,2,140,#00A8FB);
textout_p("Save As",35,122,1,#00A8FB);
END;
IF TQ({0,141},{120,170})THEN dataVP(12):=5;
BLIT(G2);
RECT_P(0,141,2,170,#00A8FB);
textout_p("Export",35,152,1,#00A8FB);
END;
IF dataVP(12)=1 THEN IF TQ({180,70},{250,85})THEN dat_inp(1,180,70,250,85);
END;
IF TQ({280,65},{310,90})THEN dataVP(27):=0;
dataVP(21):=1;
dataVP(22):=1;
dataVP(23):=0;
dataVP(24):=0;
dataVP(25):=0;
RECT_P(280,65,310,90,#08298A);
textout_p("Ok",286,70,3,#FFFFFF);
WAIT(0.5);
dataVP(1):=dataVP_L(1);
dataVP(15):={0,dataVP(1)};
dataVP(15):=SORT(dataVP(15));
dataVP(16):=[[0,1,1,1],[dataVP(1),1,1,1]];
dataVP(17):=[[0,0,0,0],[dataVP(1),0,0,0]];
dataVP(18):=[[1,0,1]];
dataVP(19):=[[0,dataVP(1),0,0]];
LOCAL N,lista_nod,mat_apoyo,dN,nod,k;
LOCAL lon;
lista_nod:=dataVP(15);
M5:=dataVP(16);
A:=dataVP(1);
N:=MAKEMAT(0,SIZE(lista_nod),2);
mat_apoyo:=MAKEMAT(0,rowDim(N),2);
FOR k FROM 1 TO rowDim(N)DO N(k,1):=lista_nod(k);
mat_apoyo(k,1):=lista_nod(k);
END;
dN:=MAKEMAT(1,rowDim(N),3);
FOR k FROM 1 TO rowDim(M5)DO FOR nod FROM 1 TO rowDim(N)DO IF M5(k,1)=lista_nod(nod)THEN dN(nod,1):=M5(k,2);
dN(nod,2):=M5(k,3);
dN(nod,3):=M5(k,4);
END;
END;
END;
apyo_in();
FOR k FROM 1 TO rowDim(N)DO IF dN(k,1)=0 AND dN(k,2)=0 AND dN(k,3)=0 THEN mat_apoyo(k,2):=0;
END;
IF dN(k,1)=0 AND dN(k,2)=0 AND dN(k,3)=1 THEN mat_apoyo(k,2):=1;
END;
IF dN(k,1)=1 AND dN(k,2)=0 AND dN(k,3)=1 THEN mat_apoyo(k,2):=2;
END;
IF dN(k,1)=1 AND dN(k,2)=1 AND dN(k,3)=1 THEN mat_apoyo(k,2):=3;
END;
IF dN(k,1)=1 AND dN(k,2)=1 AND dN(k,3)=0 THEN mat_apoyo(k,2):=4;
END;
END;
lon:=MAKEMAT(0,rowDim(N)-1,1);
for k from 1 to rowDim(N)-1 do lon(k,1):=N(k+1,1)-N(k,1);
end;
RECT_P(G1,0,52,320,240,#FFFFFF);
line_p(G1,30,129,290,129,#2E2E2E);
line_p(G1,30,130,290,130,#2E2E2E);
line_p(G1,30,131,290,131,#2E2E2E);
line_p(G1,30,221,290,221,#848484);
line_p(G1,30,235,290,235,#04B4AE);
if A<=50 then for k from 1 to A do line_p(G1,30+k*(260/A),233,30+k*(260/A),237,#04B4AE);
end;
end;
for k from 1 to rowDim(mat_apoyo)do line_p(G1,30+mat_apoyo(k,1)*(260/A),216,30+mat_apoyo(k,1)*(260/A),225,#848484);
line_p(G1,26+mat_apoyo(k,1)*(260/A),218,34+mat_apoyo(k,1)*(260/A),223,#848484);
textout_p(mat_apoyo(k,1),G1,26+mat_apoyo(k,1)*(260/A),231,1,0,100,#FFFFFF);
end;
for k from 1 to rowDim(mat_apoyo)-1 do textout_p(lon(k,1),G1,25+(mat_apoyo(k,1)+(lon(k,1)/2))*(260/A),223,1,#848484);
end;
BLIT(G1);
MOUSE1();
END;
END;
IF dataVP(12)=2 THEN IF TQ({130,40},{320,70})THEN RECT_P(130,40,310,70,0,{#BF00FF,200});
wait(0.4);
if fileVP(6)≠0 then dataVP(27):=1;
opn_datvp;
else BLIT(G2);
RECT_P(0,0,320,240,0,{#1C1C1C,100});
RECT_P(60,80,270,150,0,#1C1C1C);
TEXTOUT_P("Empty folder Error",130,110,2,#FFFFFF);
TEXTOUT_P("!",100,100,7,#FF0000);
wait(1.2);
BLIT(G1);
MOUSE1();
end;
END;
IF TQ({130,80},{320,110})THEN RECT_P(130,80,310,110,0,{#BF00FF,200});
wait(0.4);
if fileVP(7)≠0 then dataVP(27):=2;
opn_datvp;
else BLIT(G2);
RECT_P(0,0,320,240,0,{#1C1C1C,100});
RECT_P(60,80,270,150,0,#1C1C1C);
TEXTOUT_P("Empty folder Error",130,110,2,#FFFFFF);
TEXTOUT_P("!",100,100,7,#FF0000);
wait(1.2);
BLIT(G1);
MOUSE1();
end;
END;
IF TQ({130,120},{320,150})THEN RECT_P(130,120,310,150,0,{#BF00FF,200});
wait(0.4);
if fileVP(8)≠0 then dataVP(27):=3;
opn_datvp;
else BLIT(G2);
RECT_P(0,0,320,240,0,{#1C1C1C,100});
RECT_P(60,80,270,150,0,#1C1C1C);
TEXTOUT_P("Empty folder Error",130,110,2,#FFFFFF);
TEXTOUT_P("!",100,100,7,#FF0000);
wait(1.2);
BLIT(G1);
MOUSE1();
end;
END;
IF TQ({130,160},{320,190})THEN RECT_P(130,160,310,190,0,{#BF00FF,200});
wait(0.4);
if fileVP(9)≠0 then dataVP(27):=4;
opn_datvp;
else BLIT(G2);
RECT_P(0,0,320,240,0,{#1C1C1C,100});
RECT_P(60,80,270,150,0,#1C1C1C);
TEXTOUT_P("Empty folder Error",130,110,2,#FFFFFF);
TEXTOUT_P("!",100,100,7,#FF0000);
wait(1.2);
BLIT(G1);
MOUSE1();
end;
END;
IF TQ({130,200},{320,230})THEN RECT_P(130,200,310,230,0,{#BF00FF,200});
wait(0.4);
if fileVP(10)≠0 then dataVP(27):=5;
opn_datvp;
else BLIT(G2);
RECT_P(0,0,320,240,0,{#1C1C1C,100});
RECT_P(60,80,270,150,0,#1C1C1C);
TEXTOUT_P("Empty folder Error",130,110,2,#FFFFFF);
TEXTOUT_P("!",100,100,7,#FF0000);
wait(1.2);
BLIT(G1);
MOUSE1();
end;
END;
END;
IF dataVP(12)=3 THEN IF TQ({130,40},{320,70})THEN RECT_P(130,40,310,70,0,{#BF00FF,200});
wait(0.4);
dataVP(27):=1;
may_tlc();
mouse3;
END;
IF TQ({130,80},{320,110})THEN RECT_P(130,80,310,110,0,{#BF00FF,200});
wait(0.4);
dataVP(27):=2;
may_tlc();
mouse3;
END;
IF TQ({130,120},{320,150})THEN RECT_P(130,120,310,150,0,{#BF00FF,200});
wait(0.4);
dataVP(27):=3;
may_tlc();
mouse3;
END;
IF TQ({130,160},{320,190})THEN RECT_P(130,160,310,190,0,{#BF00FF,200});
wait(0.4);
dataVP(27):=4;
may_tlc();
mouse3;
END;
IF TQ({130,200},{320,230})THEN RECT_P(130,200,310,230,0,{#BF00FF,200});
wait(0.4);
dataVP(27):=5;
may_tlc();
mouse3;
END;
END;
IF TQ({0,171},{120,200})THEN HAngle:=dataVP(28);
com_nd();
END;
IF TQ({0,0},{30,20})THEN BLIT(G1);
MOUSE1();
END;
END;
END;
UNTIL 0;
END;
mouse_apy()BEGIN REPEAT time_dat;
Coor:=WAIT(-1);
IF TYPE(Coor)THEN LOCAL Tipo=Coor(1),k;
apyo_in();
IF Tipo=3 THEN IF TQ({157,92},{173,108})THEN dataVP(14):=0;
dataVP(20):=[[0],[0],[0]];
RECT_P(60,95,70,105,#000000,#FFFFFF);
RECT_P(110,95,120,105,#000000,#FFFFFF);
RECT_P(160,95,170,105,#07B593,#FFFFFF);
RECT_P(210,95,220,105,#000000,#FFFFFF);
RECT_P(260,95,270,105,#000000,#FFFFFF);
textout_p("✔",161,95,1,#07B593);
RECT_P(50,135,80,160,#FFFFFF);
textout_p("▓",57,141,2,#1C1C1C);
textout_p("▂",63,129,4,#1C1C1C);
END;
IF TQ({57,92},{73,108})THEN dataVP(14):=1;
dataVP(20):=[[0],[0],[1]];
RECT_P(60,95,70,105,#07B593,#FFFFFF);
RECT_P(110,95,120,105,#000000,#FFFFFF);
RECT_P(160,95,170,105,#000000,#FFFFFF);
RECT_P(210,95,220,105,#000000,#FFFFFF);
RECT_P(260,95,270,105,#000000,#FFFFFF);
textout_p("✔",61,95,1,#07B593);
RECT_P(50,135,80,160,#FFFFFF);
textout_p("︿",54,127,7,#1C1C1C);
textout_p("—",55,133,6,#1C1C1C);
textout_p("—",55,135,6,#1C1C1C);
END;
IF TQ({107,92},{123,108})THEN dataVP(14):=2;
dataVP(20):=[[1],[0],[1]];
RECT_P(60,95,70,105,#000000,#FFFFFF);
RECT_P(110,95,120,105,#07B593,#FFFFFF);
RECT_P(160,95,170,105,#000000,#FFFFFF);
RECT_P(210,95,220,105,#000000,#FFFFFF);
RECT_P(260,95,270,105,#000000,#FFFFFF);
textout_p("✔",111,95,1,#07B593);
RECT_P(50,135,80,160,#FFFFFF);
textout_p("︿",54,126,7,#1C1C1C);
textout_p("—",55,132,6,#1C1C1C);
textout_p("●●●",56,144,1,#1C1C1C);
END;
IF TQ({207,92},{223,108})THEN dataVP(14):=4;
dataVP(20):=[[1],[1],[0]];
RECT_P(60,95,70,105,#000000,#FFFFFF);
RECT_P(110,95,120,105,#000000,#FFFFFF);
RECT_P(160,95,170,105,#000000,#FFFFFF);
RECT_P(210,95,220,105,#07B593,#FFFFFF);
RECT_P(260,95,270,105,#000000,#FFFFFF);
textout_p("✔",211,95,1,#07B593);
RECT_P(50,135,80,160,#FFFFFF);
textout_p("▂▂",54,127,5,#1C1C1C);
textout_p("●",62,142,1,#FAFAFA);
END;
IF TQ({110,136},{170,151})THEN dat_inp(2,110,136,170,151);
dataVP(2):=dataVP_L(2);
END;
IF TQ({1,220},{51,240})THEN BLIT(G1);
MOUSE1();
END;
IF TQ({266,220},{320,240})THEN local k,l_mapy,yes_nod,pos_nod;
local tip_nodoo;
M5:=dataVP(16);
tip_nodoo:=dataVP(20);
l_mapy:=list2mat(dataVP(15),1);
FOR k FROM 1 TO rowDim(l_mapy)DO if l_mapy(k,1)=dataVP(2)then yes_nod:=1;
pos_nod:=k;
end;
END;
IF yes_nod=1 THEN l_mapy(pos_nod,1):=dataVP(2);
FOR k FROM 1 TO rowDim(l_mapy)DO if M5(k,1)=dataVP(2)then M5(k,2):=tip_nodoo(1,1);
M5(k,3):=tip_nodoo(2,1);
M5(k,4):=tip_nodoo(3,1);
end;
END;
ELSE ADDROW(l_mapy,[dataVP(2)],1);
ADDROW(M5,[dataVP(2),tip_nodoo(1,1),tip_nodoo(2,1),tip_nodoo(3,1)],1);
END;
dataVP(15):=mat2list(l_mapy);
dataVP(15):=SORT(dataVP(15));
dataVP(16):=M5;
M0:=MAKEMAT(0,SIZE(dataVP(15))-1,3);
FOR k FROM 1 TO rowDim(M0)DO M0(k,1):=1;
M0(k,2):=0;
M0(k,3):=1;
END;
dataVP(18):=M0;
diag_gen();
BLIT(G1);
MOUSE1();
END;
END;
END;
UNTIL 0;
END;
SELECT_apy BEGIN dataVP(14):=1;
dataVP(20):=[[0],[0],[1]];
RECT_P(0,22,320,240,#FFFFFF);
textout_p("Beam Support",5,25,5,#0172F3);
LINE_P(0,200,320,200,#BDBDBD);
DRAWMENU("Cancel","","help","","","Ok");
RECT_P(0,55,320,70,{#0B2161,200});
textout_p("Selected",52,57,2,#424242);
textout_p("︿",54,67,7,#1C1C1C);
textout_p("—",55,73,6,#1C1C1C);
textout_p("—",55,75,6,#1C1C1C);
textout_p("︿",104,66,7,#1C1C1C);
textout_p("—",105,72,6,#1C1C1C);
textout_p("●●●",106,84,1,#1C1C1C);
textout_p("▓",157,81,2,#1C1C1C);
textout_p("▂",163,69,4,#1C1C1C);
textout_p("▂▂",204,67,5,#1C1C1C);
textout_p("●",212,82,1,#FAFAFA);
textout_p("<",261,73,2,#1C1C1C);
textout_p(">",264,77,2,#1C1C1C);
textout_p("<",261,82,2,#1C1C1C);
textout_p(">",264,86,2,#1C1C1C);
RECT_P(60,95,70,105,#000000,#FFFFFF);
RECT_P(110,95,120,105,#000000,#FFFFFF);
RECT_P(160,95,170,105,#000000,#FFFFFF);
RECT_P(210,95,220,105,#000000,#FFFFFF);
RECT_P(260,95,270,105,#000000,#FFFFFF);
RECT_P(0,118,320,133,{#0B2161,200});
textout_p("Type",52,120,2,#424242);
IF dataVP(14)=0 THEN RECT_P(160,95,170,105,#07B593,#FFFFFF);
textout_p("✔",161,95,1,#07B593);
textout_p("▓",57,141,2,#1C1C1C);
textout_p("▂",63,129,4,#1C1C1C);
END;
IF dataVP(14)=1 THEN RECT_P(60,95,70,105,#07B593,#FFFFFF);
textout_p("✔",61,95,1,#07B593);
textout_p("︿",54,127,7,#1C1C1C);
textout_p("—",55,133,6,#1C1C1C);
textout_p("—",55,135,6,#1C1C1C);
END;
IF dataVP(14)=2 THEN RECT_P(110,95,120,105,#07B593,#FFFFFF);
textout_p("✔",111,95,1,#07B593);
textout_p("︿",54,126,7,#1C1C1C);
textout_p("—",55,132,6,#1C1C1C);
textout_p("●●●",56,144,1,#1C1C1C);
END;
IF dataVP(14)=4 THEN RECT_P(210,95,220,105,#07B593,#FFFFFF);
textout_p("✔",211,95,1,#07B593);
textout_p("▂▂",54,127,5,#1C1C1C);
textout_p("●",62,142,1,#FAFAFA);
END;
textout_p("Axis X",116,120,2,#424242);
RECT_P(110,136,170,151,#1C1C1C,#FFFFFF);
textout_p(0,113,138,2,#424242);
dataVP_L(2):=0;
dataVP(2):=0;
mouse_apy()END;
SELECT_fuerza BEGIN dataVP(11):=0;
RECT_P(0,22,320,240,#FFFFFF);
textout_p("Force Data",5,25,5,#0172F3);
LINE_P(0,200,320,200,#BDBDBD);
DRAWMENU("Home","","","","","");
RECT_P(215,35,320,50,{#0B2161,200});
textout_p("Selected",247,37,2,#424242);
LINE_P(210,35,210,190,#BDBDBD);
textout_p("Force",250,64,1,#2E2E2E);
textout_p("↓",226,52,3,#2E2E2E);
textout_p("▂▂",221,57,3,#2E2E2E);
textout_p("Moment",250,94,1,#2E2E2E);
textout_p("↶",220,82,5,#2E2E2E);
textout_p("▂▂",221,87,3,#2E2E2E);
textout_p("Distribut.",250,124,1,#2E2E2E);
textout_p("↓↓↓↓↓",215,116,2,#2E2E2E);
line_p(218,114,218,128,#2E2E2E);
line_p(224,115,224,128,#2E2E2E);
line_p(230,116,230,128,#2E2E2E);
line_p(236,117,236,128,#2E2E2E);
line_p(242,118,242,128,#2E2E2E);
line_p(218,114,242,118,#2E2E2E);
textout_p("▂▂▂▂",216,121,2,#2E2E2E);
mouse_frz()END;
mouse_frz()BEGIN REPEAT time_dat;
Coor:=WAIT(-1);
IF TYPE(Coor)THEN LOCAL Tipo=Coor(1),k;
IF Tipo=3 THEN IF TQ({210,51},{320,80})THEN dataVP(11):=1;
dataVP(13):=0;
dataVP(20):=[[1],[1],[1]];
RECT_P(0,51,320,190,#FFFFFF);
LINE_P(210,51,210,190,#BDBDBD);
DRAWMENU("Cancel","","","","","Ok");
textout_p("Moment",250,94,1,#2E2E2E);
textout_p("↶",220,82,5,#2E2E2E);
textout_p("▂▂",221,87,3,#2E2E2E);
textout_p("Distribut.",250,124,1,#2E2E2E);
textout_p("↓↓↓↓↓",215,116,2,#2E2E2E);
line_p(218,114,218,128,#2E2E2E);
line_p(224,115,224,128,#2E2E2E);
line_p(230,116,230,128,#2E2E2E);
line_p(236,117,236,128,#2E2E2E);
line_p(242,118,242,128,#2E2E2E);
line_p(218,114,242,118,#2E2E2E);
textout_p("▂▂▂▂",216,121,2,#2E2E2E);
RECT_P(210,51,213,80,#0F9F9C);
textout_p("Force",250,64,1,#0F9F9C);
textout_p("↓",226,52,3,#0F9F9C);
textout_p("▂▂",221,57,3,#0F9F9C);
textout_p("address",5,60,2,#2E2E2E);
textout_p("Axis X",70,60,2,#2E2E2E);
textout_p("Force",150,60,2,#2E2E2E);
RECT_P(10,80,40,110,0,#FFFFFF);
textout_p("↓",20,79,7,#0000FF);
RECT_P(70,80,110,95,0,#FFFFFF);
textout_p("X =",50,83,2,#2E2E2E);
RECT_P(150,80,200,95,0,#FFFFFF);
textout_p("F =",130,83,2,#2E2E2E);
dataVP_L(3):=0;
dataVP_L(4):=0;
dataVP(3):=0;
dataVP(4):=0;
textout_p(dataVP(3),72,82,2,#424242);
textout_p(dataVP(4),152,82,2,#424242);
END;
IF TQ({210,81},{320,110})THEN dataVP(11):=2;
dataVP(13):=0;
dataVP(20):=[[1],[1],[1]];
RECT_P(0,51,320,190,#FFFFFF);
LINE_P(210,51,210,190,#BDBDBD);
DRAWMENU("Cancel","","","","","Ok");
textout_p("Force",250,64,1,#2E2E2E);
textout_p("↓",226,52,3,#2E2E2E);
textout_p("▂▂",221,57,3,#2E2E2E);
textout_p("Distribut.",250,124,1,#2E2E2E);
textout_p("↓↓↓↓↓",215,116,2,#2E2E2E);
line_p(218,114,218,128,#2E2E2E);
line_p(224,115,224,128,#2E2E2E);
line_p(230,116,230,128,#2E2E2E);
line_p(236,117,236,128,#2E2E2E);
line_p(242,118,242,128,#2E2E2E);
line_p(218,114,242,118,#2E2E2E);
textout_p("▂▂▂▂",216,121,2,#2E2E2E);
RECT_P(210,81,213,110,#0F9F9C);
textout_p("Moment",250,94,1,#0F9F9C);
textout_p("↶",220,82,5,#0F9F9C);
textout_p("▂▂",221,87,3,#0F9F9C);
textout_p("address",5,60,2,#2E2E2E);
textout_p("Axis X",70,60,2,#2E2E2E);
textout_p("Force",150,60,2,#2E2E2E);
RECT_P(10,80,40,110,0,#FFFFFF);
textout_p("↷",15,79,7,#0000FF);
RECT_P(70,80,110,95,0,#FFFFFF);
textout_p("X =",50,83,2,#2E2E2E);
RECT_P(150,80,200,95,0,#FFFFFF);
textout_p("F =",130,83,2,#2E2E2E);
dataVP_L(5):=0;
dataVP_L(6):=0;
dataVP(5):=0;
dataVP(6):=0;
textout_p(dataVP(5),72,82,2,#424242);
textout_p(dataVP(6),152,82,2,#424242);
END;
IF TQ({210,111},{320,140})THEN dataVP(13):=0;
dataVP(11):=3;
dataVP(20):=[[1],[1],[1]];
RECT_P(0,51,320,190,#FFFFFF);
LINE_P(210,51,210,190,#BDBDBD);
DRAWMENU("Cancel","","","","","Ok");
textout_p("Force",250,64,1,#2E2E2E);
textout_p("↓",226,52,3,#2E2E2E);
textout_p("▂▂",221,57,3,#2E2E2E);
textout_p("Moment",250,94,1,#2E2E2E);
textout_p("↶",220,82,5,#2E2E2E);
textout_p("▂▂",221,87,3,#2E2E2E);
RECT_P(210,111,213,140,#0F9F9C);
textout_p("Distribut.",250,124,1,#0F9F9C);
textout_p("↓↓↓↓↓",215,116,2,#0F9F9C);
line_p(218,114,218,128,#0F9F9C);
line_p(224,115,224,128,#0F9F9C);
line_p(230,116,230,128,#0F9F9C);
line_p(236,117,236,128,#0F9F9C);
line_p(242,118,242,128,#0F9F9C);
line_p(218,114,242,118,#0F9F9C);
textout_p("▂▂▂▂",216,121,2,#0F9F9C);
textout_p("address",5,60,2,#2E2E2E);
textout_p("Axis X",70,60,2,#2E2E2E);
textout_p("Force",150,60,2,#2E2E2E);
RECT_P(10,80,40,110,0,#FFFFFF);
textout_p("↓↓↓↓",12,86,3,#0000FF);
RECT_P(70,80,110,95,0,#FFFFFF);
textout_p("X₁=",50,83,2,#2E2E2E);
RECT_P(150,80,200,95,0,#FFFFFF);
textout_p("F₁=",130,83,2,#2E2E2E);
RECT_P(70,105,110,120,0,#FFFFFF);
textout_p("X₂=",50,108,2,#2E2E2E);
RECT_P(150,105,200,120,0,#FFFFFF);
textout_p("F₂=",130,108,2,#2E2E2E);
dataVP_L(7):=0;
dataVP_L(8):=0;
dataVP_L(9):=0;
dataVP_L(10):=0;
dataVP(7):=0;
dataVP(8):=0;
dataVP(9):=0;
dataVP(10):=0;
textout_p(dataVP(7),72,82,2,#424242);
textout_p(dataVP(8),152,82,2,#424242);
textout_p(dataVP(9),72,107,2,#424242);
textout_p(dataVP(10),152,107,2,#424242);
END;
IF dataVP(11)=1 THEN IF TQ({10,80},{40,110})THEN dataVP(13):=dataVP(13)+1;
if dataVP(13)=2 then dataVP(13):=0;
end;
if dataVP(13)=0 then RECT_P(10,80,40,110,0,#FFFFFF);
textout_p("↓",20,79,7,#0000FF);
end;
if dataVP(13)=1 then RECT_P(10,80,40,110,0,#FFFFFF);
textout_p("↑",20,79,7,#DF0101);
end;
END;
IF TQ({70,80},{110,95})THEN dat_inp(3,70,80,110,95);
dataVP(3):=dataVP_L(3);
END;
IF TQ({150,80},{200,95})THEN dat_inp(4,150,80,200,95);
dataVP(4):=dataVP_L(4);
END;
IF TQ({1,220},{51,240})THEN BLIT(G1);
MOUSE1();
END;
IF TQ({266,220},{320,240})THEN local k,l_mapy,yes_nod,pos_nod;
local tip_nodoo,dr_c;
local val2:=carg_ines,val1:=carg_punt,val3:=mon_fl;
IF dataVP(13)=0 then dr_c:=-1;
ELSE dr_c:=1;
END;
M5:=dataVP(16);
M2:=dataVP(17);
tip_nodoo:=dataVP(20);
l_mapy:=list2mat(dataVP(15),1);
FOR k FROM 1 TO rowDim(l_mapy)DO if l_mapy(k,1)=dataVP(3)then yes_nod:=1;
pos_nod:=k;
end;
END;
IF yes_nod=1 THEN l_mapy(pos_nod,1):=dataVP(3);
FOR k FROM 1 TO rowDim(M2)DO if M2(k,1)=dataVP(3)then M2(k,3):=dr_c*dataVP(4);
end;
END;
ELSE ADDROW(l_mapy,[dataVP(3)],1);
ADDROW(M5,[dataVP(3),tip_nodoo(1,1),tip_nodoo(2,1),tip_nodoo(3,1)],1);
ADDROW(M2,[dataVP(3),0,dr_c*dataVP(4),0],1);
END;
dataVP(15):=mat2list(l_mapy);
dataVP(15):=SORT(dataVP(15));
dataVP(16):=M5;
dataVP(17):=M2;
M0:=MAKEMAT(0,SIZE(dataVP(15))-1,3);
FOR k FROM 1 TO rowDim(M0)DO M0(k,1):=1;
M0(k,2):=0;
M0(k,3):=1;
END;
dataVP(18):=M0;
diag_gen();
BLIT(G1);
MOUSE1();
END;
END;
IF dataVP(11)=2 THEN IF TQ({10,80},{40,110})THEN dataVP(13):=dataVP(13)+1;
if dataVP(13)=2 then dataVP(13):=0;
end;
if dataVP(13)=0 then RECT_P(10,80,40,110,0,#FFFFFF);
textout_p("↷",15,79,7,#0000FF);
end;
if dataVP(13)=1 then RECT_P(10,80,40,110,0,#FFFFFF);
textout_p("↶",15,79,7,#DF0101);
end;
END;
IF TQ({70,80},{110,95})THEN dat_inp(5,70,80,110,95);
dataVP(5):=dataVP_L(5);
END;
IF TQ({150,80},{200,95})THEN dat_inp(6,150,80,200,95);
dataVP(6):=dataVP_L(6);
END;
IF TQ({1,220},{51,240})THEN BLIT(G1);
MOUSE1();
END;
IF TQ({266,220},{320,240})THEN local k,l_mapy,yes_nod,pos_nod,val3:=mon_fl;
local tip_nodoo,dr_c,val1:=carg_punt;
local val2:=carg_ines;
IF dataVP(13)=0 then dr_c:=-1;
ELSE dr_c:=1;
END;
M5:=dataVP(16);
M2:=dataVP(17);
tip_nodoo:=dataVP(20);
l_mapy:=list2mat(dataVP(15),1);
FOR k FROM 1 TO rowDim(l_mapy)DO if l_mapy(k,1)=dataVP(5)then yes_nod:=1;
pos_nod:=k;
end;
END;
IF yes_nod=1 THEN l_mapy(pos_nod,1):=dataVP(5);
FOR k FROM 1 TO rowDim(M2)DO if M2(k,1)=dataVP(5)then M2(k,4):=dr_c*dataVP(6);
end;
END;
ELSE ADDROW(l_mapy,[dataVP(5)],1);
ADDROW(M5,[dataVP(5),tip_nodoo(1,1),tip_nodoo(2,1),tip_nodoo(3,1)],1);
ADDROW(M2,[dataVP(5),0,0,dr_c*dataVP(6)],1);
END;
dataVP(15):=mat2list(l_mapy);
dataVP(15):=SORT(dataVP(15));
dataVP(16):=M5;
dataVP(17):=M2;
M0:=MAKEMAT(0,SIZE(dataVP(15))-1,3);
FOR k FROM 1 TO rowDim(M0)DO M0(k,1):=1;
M0(k,2):=0;
M0(k,3):=1;
END;
dataVP(18):=M0;
diag_gen();
BLIT(G1);
MOUSE1();
END;
END;
IF dataVP(11)=3 THEN IF TQ({10,80},{40,110})THEN dataVP(13):=dataVP(13)+1;
if dataVP(13)=2 then dataVP(13):=0;
end;
if dataVP(13)=0 then RECT_P(10,80,40,110,0,#FFFFFF);
textout_p("↓↓↓↓",12,86,3,#0000FF);
end;
if dataVP(13)=1 then RECT_P(10,80,40,110,0,#FFFFFF);
textout_p("↑↑↑↑",12,86,3,#DF0101);
end;
END;
IF TQ({70,80},{110,95})THEN dat_inp(7,70,80,110,95);
dataVP(7):=dataVP_L(7);
END;
IF TQ({150,80},{200,95})THEN dat_inp(8,150,80,200,95);
dataVP(8):=dataVP_L(8);
END;
IF TQ({70,105},{110,120})THEN dat_inp(9,70,105,110,120);
dataVP(9):=dataVP_L(9);
END;
IF TQ({150,105},{200,120})THEN dat_inp(10,150,105,200,120);
dataVP(10):=dataVP_L(10);
END;
IF TQ({1,220},{51,240})THEN BLIT(G1);
MOUSE1();
END;
IF TQ({266,220},{320,240})THEN local k,l_mapy,yes_nod,pos_nod;
local tip_nodoo,dr_c,nod;
IF dataVP(13)=0 then dr_c:=-1;
ELSE dr_c:=1;
END;
M5:=dataVP(16);
M2:=dataVP(17);
M1:=dataVP(19);
tip_nodoo:=dataVP(20);
l_mapy:=list2mat(dataVP(15),1);
FOR k FROM 1 TO rowDim(l_mapy)DO if l_mapy(k,1)=dataVP(7)then yes_nod:=1;
pos_nod:=k;
end;
END;
IF yes_nod=1 THEN l_mapy(pos_nod,1):=dataVP(7);
ELSE ADDROW(l_mapy,[dataVP(7)],1);
ADDROW(M5,[dataVP(7),tip_nodoo(1,1),tip_nodoo(2,1),tip_nodoo(3,1)],1);
END;
local yes_nod,pos_nod,ext_c,ext_pos;
FOR k FROM 1 TO rowDim(l_mapy)DO if l_mapy(k,1)=dataVP(9)then yes_nod:=1;
pos_nod:=k;
end;
END;
IF yes_nod=1 THEN l_mapy(pos_nod,1):=dataVP(9);
ELSE ADDROW(l_mapy,[dataVP(9)],1);
ADDROW(M5,[dataVP(9),tip_nodoo(1,1),tip_nodoo(2,1),tip_nodoo(3,1)],1);
END;
FOR k FROM 1 TO rowDim(M1)DO IF M1(k,1)=dataVP(7)AND M1(k,2)=dataVP(9)THEN ext_c:=1;
ext_pos:=k;
END;
END;
IF ext_c=1 THEN M1(ext_pos,3):=dr_c*dataVP(8);
M1(ext_pos,4):=dr_c*dataVP(10);
ELSE ADDROW(M1,[dataVP(7),dataVP(9),dr_c*dataVP(8),dr_c*dataVP(10)],1);
END;
dataVP(15):=mat2list(l_mapy);
dataVP(15):=SORT(dataVP(15));
dataVP(16):=M5;
dataVP(17):=M2;
dataVP(19):=M1;
M0:=MAKEMAT(0,SIZE(dataVP(15))-1,3);
FOR k FROM 1 TO rowDim(M0)DO M0(k,1):=1;
M0(k,2):=0;
M0(k,3):=1;
END;
dataVP(18):=M0;
diag_gen();
BLIT(G1);
MOUSE1();
END;
END;
IF TQ({1,220},{51,240})THEN BLIT(G1);
MOUSE1();
END;
END;
END;
UNTIL 0;
END;
apyo_in()BEGIN LOCAL ompl:={2897,1938,2489,3554,1022};
LOCAL val2:=carg_ines,val1:=carg_punt,val3:=mon_fl;
print;
LOCAL select_apyo,coor,dist_c,apoyo_mov;
dist_c:=MID(val2,ompl(1),ns_in);
coor:=MID(val2,ompl(2),6);
apoyo_mov:=ROTATE(coor,-2);
if EXPR(apoyo_mov)=dist_c then else com_nd();
end;
END;
diag_gen()BEGIN LOCAL N,lista_nod,mat_apoyo,dN,nod,k;
LOCAL lon;
lista_nod:=dataVP(15);
M5:=dataVP(16);
M2:=dataVP(17);
M1:=dataVP(19);
A:=dataVP(1);
N:=MAKEMAT(0,SIZE(lista_nod),2);
mat_apoyo:=MAKEMAT(0,rowDim(N),2);
FOR k FROM 1 TO rowDim(N)DO N(k,1):=lista_nod(k);
mat_apoyo(k,1):=lista_nod(k);
END;
dN:=MAKEMAT(1,rowDim(N),3);
FOR k FROM 1 TO rowDim(M5)DO FOR nod FROM 1 TO rowDim(N)DO IF M5(k,1)=lista_nod(nod)THEN dN(nod,1):=M5(k,2);
dN(nod,2):=M5(k,3);
dN(nod,3):=M5(k,4);
END;
END;
END;
FOR k FROM 1 TO rowDim(N)DO IF dN(k,1)=0 AND dN(k,2)=0 AND dN(k,3)=0 THEN mat_apoyo(k,2):=0;
END;
IF dN(k,1)=0 AND dN(k,2)=0 AND dN(k,3)=1 THEN mat_apoyo(k,2):=1;
END;
IF dN(k,1)=1 AND dN(k,2)=0 AND dN(k,3)=1 THEN mat_apoyo(k,2):=2;
END;
IF dN(k,1)=1 AND dN(k,2)=1 AND dN(k,3)=1 THEN mat_apoyo(k,2):=3;
END;
IF dN(k,1)=1 AND dN(k,2)=1 AND dN(k,3)=0 THEN mat_apoyo(k,2):=4;
END;
END;
lon:=MAKEMAT(0,rowDim(N)-1,1);
for k from 1 to rowDim(N)-1 do lon(k,1):=N(k+1,1)-N(k,1);
end;
RECT_P(G1,0,52,320,240,#FFFFFF);
line_p(G1,30,129,290,129,#2E2E2E);
line_p(G1,30,130,290,130,#2E2E2E);
line_p(G1,30,131,290,131,#2E2E2E);
line_p(G1,30,221,290,221,#848484);
line_p(G1,30,235,290,235,#04B4AE);
if A<=50 then for k from 1 to A do line_p(G1,30+k*(260/A),233,30+k*(260/A),237,#04B4AE);
end;
end;
for k from 1 to rowDim(mat_apoyo)do line_p(G1,30+mat_apoyo(k,1)*(260/A),216,30+mat_apoyo(k,1)*(260/A),225,#848484);
line_p(G1,26+mat_apoyo(k,1)*(260/A),218,34+mat_apoyo(k,1)*(260/A),223,#848484);
textout_p(mat_apoyo(k,1),G1,26+mat_apoyo(k,1)*(260/A),231,1,0,100,#FFFFFF);
end;
for k from 1 to rowDim(mat_apoyo)-1 do textout_p(lon(k,1),G1,25+(mat_apoyo(k,1)+(lon(k,1)/2))*(260/A),223,1,#848484);
end;
for k from 1 to rowDim(N)do if mat_apoyo(k,2)=0 then if mat_apoyo(k,1)=A then textout_p("▒",G1,291,126,1,#086A87);
textout_p("▒",G1,291,126,1,#086A87);
end;
if mat_apoyo(k,1)=0 then textout_p("▒",G1,24,126,1,#086A87);
textout_p("▒",G1,24,126,1,#086A87);
end;
if 0<mat_apoyo(k,1)<A then textout_p("▒",G1,27+mat_apoyo(k,1)*(260/A),126,1,#086A87);
textout_p("▒",G1,27+mat_apoyo(k,1)*(260/A),126,1,#086A87);
end;
end;
if mat_apoyo(k,2)=1 then textout_p("︿",G1,20+mat_apoyo(k,1)*(260/A),118,7,#086A87);
textout_p("—",G1,22+mat_apoyo(k,1)*(260/A),124,5,#086A87);
textout_p("—",G1,22+mat_apoyo(k,1)*(260/A),126,5,#086A87);
textout_p("—",G1,22+mat_apoyo(k,1)*(260/A),127,5,#086A87);
end;
if mat_apoyo(k,2)=2 then textout_p("︿",G1,20+mat_apoyo(k,1)*(260/A),118,7,#086A87);
textout_p("—",G1,22+mat_apoyo(k,1)*(260/A),124,5,#086A87);
textout_p("●●●",G1,22+mat_apoyo(k,1)*(260/A),135,1,#086A87);
end;
if mat_apoyo(k,2)=4 then textout_p("●",G1,25+mat_apoyo(k,1)*(260/A),119,5,#FFFFFF);
textout_p("●",G1,27+mat_apoyo(k,1)*(260/A),126,1,#086A87);
end;
end;
LOCAL ADDAPOYO,k,MAX_Y,rango,RANGO_Y,RANGO_Z;
LOCAL rango1,rango2,dimencar,n;
MAX_Y:=(M1(-3));
MAX_Y:=TRN(MAX_Y);
rango1:=maxnorm((MAX_Y));
MAX_Y:=(M1(-4));
MAX_Y:=TRN(MAX_Y);
rango2:=maxnorm((MAX_Y));
IF rango1<rango2 THEN RANGO_Y:=rango2/5.5;
ELSE RANGO_Y:=rango1/5.5;
END;
IF rango1=rango2 THEN RANGO_Y:=rango1/5.5;
END;
FOR k FROM 1 TO rowDim(M1)DO B:=M1(k,1);
W:=M1(k,2);
X:=M1(k,3);
Y:=M1(k,4);
dimencar:=(W-B);
dimencar:=dimencar*5*(26/A);
IF M1(k,3)≠ 0 AND M1(k,4)≠0 THEN IF M1(k,3)=M1(k,4)THEN IF M1(k,3)<0 THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2+ABS(X)/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2+ABS(X)/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+((W+B)/2)*(26/A),-2+0.9+ABS(X)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2+ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2+ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-1.7,-12.8+B*(26/A),-1.7,-13+B*(26/A),-1.9,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-1.7,-12.8+W*(26/A),-1.7,-13+W*(26/A),-1.9,#0080FFh);
END;
IF 0<M1(k,3)THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2-ABS(X)/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2-ABS(X)/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+((W+B)/2)*(26/A),-3.1+0.9-ABS(X)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2-ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2-ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-2.3,-12.8+B*(26/A),-2.3,-13+B*(26/A),-2.1,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-2.3,-12.8+W*(26/A),-2.3,-13+W*(26/A),-2.1,#0080FFh);
END;
END;
IF ABS(M1(k,3))<ABS(M1(k,4))THEN IF M1(k,3)<0 AND M1(k,4)<0 THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2+ABS(X)/RANGO_Y+(ABS(Y)-ABS(X))*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2+ABS(X)/RANGO_Y+(ABS(Y)-ABS(X))*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+B*(26/A),-2+0.9+ABS(X)/RANGO_Y,1,#0080FFh,100);
TEXTOUT(ABS(Y),G1,-13+W*(26/A),-2+0.9+ABS(Y)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2+ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2+ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-1.7,-12.8+B*(26/A),-1.7,-13+B*(26/A),-1.9,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-1.7,-12.8+W*(26/A),-1.7,-13+W*(26/A),-1.9,#0080FFh);
END;
IF 0<M1(k,3)AND 0<M1(k,4)THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2-ABS(X)/RANGO_Y-(ABS(Y)-ABS(X))*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2-ABS(X)/RANGO_Y-(ABS(Y)-ABS(X))*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+B*(26/A),-3.1+0.9-ABS(X)/RANGO_Y,1,#0080FFh,100);
TEXTOUT(ABS(Y),G1,-13+W*(26/A),-3.1+0.9-ABS(Y)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2-ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2-ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-2.3,-12.8+B*(26/A),-2.3,-13+B*(26/A),-2.1,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-2.3,-12.8+W*(26/A),-2.3,-13+W*(26/A),-2.1,#0080FFh);
END;
END;
IF ABS(M1(k,4))< ABS(M1(k,3))THEN IF M1(k,3)<0 AND M1(k,4)<0 THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2+ABS(Y)/RANGO_Y+(ABS(X)-ABS(Y))*(((W-B)-(0.5*n*A/(5*26)))/(W-B))/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2+ABS(Y)/RANGO_Y+(ABS(X)-ABS(Y))*(((W-B)-(0.5*n*A/(5*26)))/(W-B))/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+B*(26/A),-2+0.9+ABS(X)/RANGO_Y,1,#0080FFh,100);
TEXTOUT(ABS(Y),G1,-13+W*(26/A),-2+0.9+ABS(Y)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2+ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2+ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-1.7,-12.8+B*(26/A),-1.7,-13+B*(26/A),-1.9,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-1.7,-12.8+W*(26/A),-1.7,-13+W*(26/A),-1.9,#0080FFh);
END;
IF 0<M1(k,3)AND 0<M1(k,4)THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2-ABS(Y)/RANGO_Y-(ABS(X)-ABS(Y))*(((W-B)-(0.5*n*A/(5*26)))/(W-B))/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2-ABS(Y)/RANGO_Y-(ABS(X)-ABS(Y))*(((W-B)-(0.5*n*A/(5*26)))/(W-B))/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+B*(26/A),-3.1+0.9-ABS(X)/RANGO_Y,1,#0080FFh,100);
TEXTOUT(ABS(Y),G1,-13+W*(26/A),-3.1+0.9-ABS(Y)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2-ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2-ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-2.3,-12.8+B*(26/A),-2.3,-13+B*(26/A),-2.1,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-2.3,-12.8+W*(26/A),-2.3,-13+W*(26/A),-2.1,#0080FFh);
END;
END;
END;
IF M1(k,3)≠ 0 AND M1(k,4)=0 THEN IF M1(k,3)<0 THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2+ABS(X)/RANGO_Y-ABS(X)*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2+ABS(X)/RANGO_Y-ABS(X)*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+B*(26/A),-2+0.9+ABS(X)/RANGO_Y,1,#0080FFh,100);
TEXTOUT(ABS(Y),G1,-13+W*(26/A),-2+0.9+ABS(Y)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2+ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2+ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-1.7,-12.8+B*(26/A),-1.7,-13+B*(26/A),-1.9,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-1.7,-12.8+W*(26/A),-1.7,-13+W*(26/A),-1.9,#0080FFh);
END;
IF 0<M1(k,3)THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2-ABS(X)/RANGO_Y+ABS(X)*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2-ABS(X)/RANGO_Y+ABS(X)*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+B*(26/A),-3.1+0.9-ABS(X)/RANGO_Y,1,#0080FFh,100);
TEXTOUT(ABS(Y),G1,-13+W*(26/A),-3.1+0.9-ABS(Y)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2-ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2-ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-2.3,-12.8+B*(26/A),-2.3,-13+B*(26/A),-2.1,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-2.3,-12.8+W*(26/A),-2.3,-13+W*(26/A),-2.1,#0080FFh);
END;
END;
IF M1(k,3)=0 AND M1(k,4)≠0 THEN IF M1(k,4)<0 THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2+ABS(X)/RANGO_Y+ABS(Y)*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2+ABS(X)/RANGO_Y+ABS(Y)*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+B*(26/A),-2+0.9+ABS(X)/RANGO_Y,1,#0080FFh,100);
TEXTOUT(ABS(Y),G1,-13+W*(26/A),-2+0.9+ABS(Y)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2+ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2+ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-1.7,-12.8+B*(26/A),-1.7,-13+B*(26/A),-1.9,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-1.7,-12.8+W*(26/A),-1.7,-13+W*(26/A),-1.9,#0080FFh);
END;
IF 0<M1(k,4)THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2-ABS(X)/RANGO_Y-ABS(Y)*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2-ABS(X)/RANGO_Y-ABS(Y)*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+B*(26/A),-3.1+0.9-ABS(X)/RANGO_Y,1,#0080FFh,100);
TEXTOUT(ABS(Y),G1,-13+W*(26/A),-3.1+0.9-ABS(Y)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2-ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2-ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-2.3,-12.8+B*(26/A),-2.3,-13+B*(26/A),-2.1,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-2.3,-12.8+W*(26/A),-2.3,-13+W*(26/A),-2.1,#0080FFh);
END;
END;
END;
FOR k FROM 1 TO rowDim(M1)DO B:=M1(k,1);
W:=M1(k,2);
X:=M1(k,3);
Y:=M1(k,4);
dimencar:=(W-B);
dimencar:=dimencar*5*(26/A);
IF M1(k,3)≠ 0 AND M1(k,4)≠0 THEN IF M1(k,3)=M1(k,4)THEN IF M1(k,3)<0 THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2+ABS(X)/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-1.7,-12.7+0.8*n+B*(26/A),-1.7,-12.9+0.8*n+B*(26/A),-1.9,#0080FFh);
END;
END;
IF 0<M1(k,3)THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2-ABS(X)/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-2.3,-12.7+0.8*n+B*(26/A),-2.3,-12.9+0.8*n+B*(26/A),-2.1,#0080FFh);
END;
END;
END;
IF ABS(M1(k,3))<ABS(M1(k,4))THEN IF M1(k,3)<0 AND M1(k,4)<0 THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2+ABS(X)/RANGO_Y+(ABS(Y)-ABS(X))*(((4*n*A/(5*26)))/(W-B))/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-1.7,-12.7+0.8*n+B*(26/A),-1.7,-12.9+0.8*n+B*(26/A),-1.9,#0080FFh);
END;
END;
IF 0<M1(k,3)AND 0<M1(k,4)THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2-ABS(X)/RANGO_Y-(ABS(Y)-ABS(X))*(((4*n*A/(5*26)))/(W-B))/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-2.3,-12.7+0.8*n+B*(26/A),-2.3,-12.9+0.8*n+B*(26/A),-2.1,#0080FFh);
END;
END;
END;
IF ABS(M1(k,4))< ABS(M1(k,3))THEN IF M1(k,3)<0 AND M1(k,4)<0 THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2+ABS(Y)/RANGO_Y+(ABS(X)-ABS(Y))*(((W-B)-(4*n*A/(5*26)))/(W-B))/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-1.7,-12.7+0.8*n+B*(26/A),-1.7,-12.9+0.8*n+B*(26/A),-1.9,#0080FFh);
END;
END;
IF 0<M1(k,3)AND 0<M1(k,4)THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2-ABS(Y)/RANGO_Y-(ABS(X)-ABS(Y))*(((W-B)-(4*n*A/(5*26)))/(W-B))/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-2.3,-12.7+0.8*n+B*(26/A),-2.3,-12.9+0.8*n+B*(26/A),-2.1,#0080FFh);
END;
END;
END;
END;
IF M1(k,3)≠ 0 AND M1(k,4)=0 THEN IF M1(k,3)<0 THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2+ABS(X)/RANGO_Y-ABS(X)*((4*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-1.7,-12.7+0.8*n+B*(26/A),-1.7,-12.9+0.8*n+B*(26/A),-1.9,#0080FFh);
END;
END;
IF 0<M1(k,3)THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2-ABS(X)/RANGO_Y+ABS(X)*((4*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-2.3,-12.7+0.8*n+B*(26/A),-2.3,-12.9+0.8*n+B*(26/A),-2.1,#0080FFh);
END;
END;
END;
IF M1(k,3)=0 AND M1(k,4)≠0 THEN IF M1(k,4)<0 THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2+ABS(X)/RANGO_Y+ABS(Y)*((4*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-1.7,-12.7+0.8*n+B*(26/A),-1.7,-12.9+0.8*n+B*(26/A),-1.9,#0080FFh);
END;
END;
IF 0<M1(k,4)THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2-ABS(X)/RANGO_Y-ABS(Y)*((4*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-2.3,-12.7+0.8*n+B*(26/A),-2.3,-12.9+0.8*n+B*(26/A),-2.1,#0080FFh);
END;
END;
END;
END;
LOCAL ADDAPOYO,k,MAX_Y,rango,RANGO_Y,RANGO_Z;
MAX_Y:=(M2(-3));
MAX_Y:=TRN(MAX_Y);
rango:=maxnorm((MAX_Y));
RANGO_Y:=rango/6;
FOR k FROM 1 TO rowDim(M2)DO IF 0<=M2(k,1)<=A THEN IF M2(k,3)<0 THEN TRIANGLE(G1,-13.2+M2(k,1)*(26/A),-1.7,-12.8+M2(k,1)*(26/A),-1.7,-13+M2(k,1)*(26/A),-1.9,#FF8000h);
LINE(G1,-13+M2(k,1)*(26/A),-2+ABS(M2(k,3))/RANGO_Y,-13+M2(k,1)*(26/A),-2,#FF8000h);
TEXTOUT(ABS(M2(k,3)),G1,-13.7+M2(k,1)*(26/A),-2+0.9+ABS(M2(k,3))/RANGO_Y,1,#FF8000h,100);
END;
IF 0<M2(k,3)THEN TRIANGLE(G1,-13.2+M2(k,1)*(26/A),-2.3,-12.8+M2(k,1)*(26/A),-2.3,-13+M2(k,1)*(26/A),-2.1,#FF8000h);
LINE(G1,-13+M2(k,1)*(26/A),-2,-13+M2(k,1)*(26/A),-2-ABS(M2(k,3))/RANGO_Y,#FF8000h);
TEXTOUT(ABS(M2(k,3)),G1,-13.7+M2(k,1)*(26/A),-3.1+0.9-ABS(M2(k,3))/RANGO_Y,1,#FF8000h,100);
END;
END;
END;
FOR k FROM 1 TO rowDim(M2)DO IF 0<=M2(k,1)<=A THEN IF M2(k,4)<0 THEN TEXTOUT("↻",G1,-13.7+M2(k,1)*(26/A),-1.3,3,#FF00FFh,100);
TEXTOUT(M2(k,4),G1,-12.4+M2(k,1)*(26/A),-2.3,1,#FF00FFh,100);
END;
IF 0<M2(k,4)THEN TEXTOUT("↺",G1,-13.7+M2(k,1)*(26/A),-1.3,3,#FF00FFh,100);
TEXTOUT(M2(k,4),G1,-12.4+M2(k,1)*(26/A),-2.3,1,#FF00FFh,100);
END;
END;
END;
END;
mouse3 BEGIN REPEAT LOCAL k,tlcd,dat,alt:=80;
if mayus=0 then tlcd:=tlcd1;
else tlcd:=tlcd2;
end;
Coor:=WAIT(-1);
IF TYPE(Coor)THEN IF Coor(1)=3 THEN FOR k:=1 TO 10 DO IF TQ({15+25*(k-1),alt+20},{15+25*k,alt+45})THEN RECT_P(15+25*(k-1),alt+20,15+25*k,alt+45,0,#FFFFFF);
TEXTOUT_P(tlcd(k),24+25*(k-1),alt+22,4,0);
WAIT(0.1);
RECT_P(15+25*(k-1),alt+20,15+25*k,alt+45,0,#0174DF);
TEXTOUT_P(tlcd(k),24+25*(k-1),alt+22,4,#FFFFFF);
dataVP_C(2):=tlcd(k);
dataVP_C(1):=dataVP_C(1)+dataVP_C(2);
RECT_P(40,60,280,85,0,#FFFFFF);
TEXTOUT_P(dataVP_C(1),45,61,5,0,225);
END;
END;
FOR k:=1 TO 10 DO IF TQ({25+25*(k-1),alt+45},{25+25*k,alt+70})THEN RECT_P(25+25*(k-1),alt+45,25+25*k,alt+70,0,#FFFFFF);
TEXTOUT_P(tlcd(10+k),34+25*(k-1),alt+47,4,0);
WAIT(0.1);
RECT_P(25+25*(k-1),alt+45,25+25*k,alt+70,0,#0174DF);
TEXTOUT_P(tlcd(10+k),34+25*(k-1),alt+47,4,#FFFFFF);
dataVP_C(2):=tlcd(10+k);
dataVP_C(1):=dataVP_C(1)+dataVP_C(2);
RECT_P(40,60,280,85,0,#FFFFFF);
TEXTOUT_P(dataVP_C(1),45,61,5,0,225);
END;
END;
FOR k:=1 TO 10 DO IF TQ({35+25*(k-1),alt+70},{35+25*k,alt+95})THEN RECT_P(35+25*(k-1),alt+70,35+25*k,alt+95,0,#FFFFFF);
TEXTOUT_P(tlcd(20+k),44+25*(k-1),alt+72,4,0);
WAIT(0.1);
RECT_P(35+25*(k-1),alt+70,35+25*k,alt+95,0,#0174DF);
TEXTOUT_P(tlcd(20+k),44+25*(k-1),alt+72,4,#FFFFFF);
dataVP_C(2):=tlcd(20+k);
dataVP_C(1):=dataVP_C(1)+dataVP_C(2);
RECT_P(40,60,280,85,0,#FFFFFF);
TEXTOUT_P(dataVP_C(1),45,61,5,0,225);
END;
END;
FOR k:=1 TO 8 DO IF TQ({45+25*(k-1),alt+95},{45+25*k,alt+120})THEN RECT_P(45+25*(k-1),alt+95,45+25*k,alt+120,0,#FFFFFF);
TEXTOUT_P(tlcd(30+k),54+25*(k-1),alt+97,4,0);
WAIT(0.1);
RECT_P(45+25*(k-1),alt+95,45+25*k,alt+120,0,#0174DF);
TEXTOUT_P(tlcd(30+k),54+25*(k-1),alt+97,4,#FFFFFF);
dataVP_C(2):=tlcd(30+k);
dataVP_C(1):=dataVP_C(1)+dataVP_C(2);
RECT_P(40,60,280,85,0,#FFFFFF);
TEXTOUT_P(dataVP_C(1),45,61,5,0,225);
END;
END;
IF TQ({265,100},{305,125})THEN RECT_P(265,100,305,125,#1C1C1C,#FFFFFF);
TEXTOUT_P("⌫",272,97,7,0);
WAIT(0.1);
RECT_P(265,100,305,125,#1C1C1C,#B40404);
TEXTOUT_P("⌫",272,97,7,#FFFFFF);
IF DIM(dataVP_C(1))≤1 THEN dataVP_C(1):="";
ELSE dataVP_C(1):=LEFT(dataVP_C(1),DIM(dataVP_C(1))-1);
END;
RECT_P(40,60,280,85,0,#FFFFFF);
TEXTOUT_P(dataVP_C(1),45,61,5,0,225);
END;
IF TQ({245,175},{285,200})THEN RECT_P(245,175,285,200,#1C1C1C,#FFFFFF);
TEXTOUT_P("Aa",255,177,5,0);
WAIT(0.1);
RECT_P(245,175,285,200,#1C1C1C,#2ECCFA);
TEXTOUT_P("Aa",255,177,5,0);
mayus:=mayus+1;
if mayus=2 then mayus:=0;
end;
may_tlc();
END;
IF TQ({1,220},{51,240})THEN BLIT(G1);
MOUSE1();
END;
IF TQ({266,220},{320,240})THEN BLIT(G1);
RECT_P(0,22,320,240,{#1C1C1C,200});
RECT_P(60,80,270,150,0,{#1C1C1C,50});
TEXTOUT_P("SAVING DATA",130,105,2,#FFFFFF);
RECT_P(90,123,240,125,0);
for k:=1 to 30 do RECT_P(90,123,90+5*k,125,#40FF00);
wait(0.02);
end;
IF dataVP(27)=1 THEN fileVP(1):=dataVP_C(1);
fileVP(6):=dataVP(27);
fileVP(11):=dataVP(1);
fileVP(16):=dataVP(15);
fileVP(21):=dataVP(16);
fileVP(26):=dataVP(17);
fileVP(31):=dataVP(18);
fileVP(36):=dataVP(19);
END;
IF dataVP(27)=2 THEN fileVP(2):=dataVP_C(1);
fileVP(7):=dataVP(27);
fileVP(12):=dataVP(1);
fileVP(17):=dataVP(15);
fileVP(22):=dataVP(16);
fileVP(27):=dataVP(17);
fileVP(32):=dataVP(18);
fileVP(37):=dataVP(19);
END;
IF dataVP(27)=3 THEN fileVP(3):=dataVP_C(1);
fileVP(8):=dataVP(27);
fileVP(13):=dataVP(1);
fileVP(18):=dataVP(15);
fileVP(23):=dataVP(16);
fileVP(28):=dataVP(17);
fileVP(33):=dataVP(18);
fileVP(38):=dataVP(19);
END;
IF dataVP(27)=4 THEN fileVP(4):=dataVP_C(1);
fileVP(9):=dataVP(27);
fileVP(14):=dataVP(1);
fileVP(19):=dataVP(15);
fileVP(24):=dataVP(16);
fileVP(29):=dataVP(17);
fileVP(34):=dataVP(18);
fileVP(39):=dataVP(19);
END;
IF dataVP(27)=5 THEN fileVP(5):=dataVP_C(1);
fileVP(10):=dataVP(27);
fileVP(15):=dataVP(1);
fileVP(20):=dataVP(15);
fileVP(25):=dataVP(16);
fileVP(30):=dataVP(17);
fileVP(35):=dataVP(18);
fileVP(40):=dataVP(19);
END;
RECT_P(60,80,270,150,0,#1C1C1C);
TEXTOUT_P("successfully saved",130,100,2,#FFFFFF);
TEXTOUT_P(dataVP_C(1),130,113,2,#FF00FF);
TEXTOUT_P("✔",100,100,7,#40FF00);
wait(1.5);
BLIT_P(G1,250,8,320,21,G1,0,8,70,21);
TEXTOUT_P(dataVP_C(1),G1,250,10,1,#00FF00);
BLIT(G1);
MOUSE1();
END;
END END UNTIL 0;
END;
may_tlc()BEGIN LOCAL k,tlcd,alt:=80;
if mayus=0 then tlcd:=tlcd1;
else tlcd:=tlcd2;
end;
BLIT(G1);
RECT_P(0,22,320,240,#FFFFFF);
RECT_P(0,22,320,50,#2E2E2E);
TEXTOUT_P("ENTER NAME OF FILE",10,27,3,#FFFFFF);
RECT_P(0,51,320,240,{#1C1C1C,200});
RECT_P(40,60,280,85,0,#FFFFFF);
TEXTOUT_P(dataVP_C(1),45,61,5,0,225);
DRAWMENU("Cancel","","","","","Ok");
FOR k:=1 TO 10 DO RECT_P(15+25*(k-1),alt+20,15+25*k,alt+45,0,#0174DF);
TEXTOUT_P(tlcd(k),24+25*(k-1),alt+22,4,#FFFFFF);
END;
FOR k:=1 TO 10 DO RECT_P(25+25*(k-1),alt+45,25+25*k,alt+70,0,#0174DF);
TEXTOUT_P(tlcd(10+k),34+25*(k-1),alt+47,4,#FFFFFF);
END;
FOR k:=1 TO 10 DO RECT_P(35+25*(k-1),alt+70,35+25*k,alt+95,0,#0174DF);
TEXTOUT_P(tlcd(20+k),44+25*(k-1),alt+72,4,#FFFFFF);
END;
FOR k:=1 TO 8 DO RECT_P(45+25*(k-1),alt+95,45+25*k,alt+120,0,#0174DF);
TEXTOUT_P(tlcd(30+k),54+25*(k-1),alt+97,4,#FFFFFF);
END;
RECT_P(245,175,285,200,#1C1C1C,#2ECCFA);
TEXTOUT_P("Aa",255,177,5,0);
RECT_P(265,100,305,125,#1C1C1C,#B40404);
TEXTOUT_P("⌫",272,97,7,#FFFFFF);
END;
in_dat BEGIN LOCAL tcl=Coor;
CASE IF 31<tcl<35 THEN tcl:=23 END IF 36<tcl<40 THEN tcl:=15 END IF 41<tcl<45 THEN tcl:=7 END IF tcl=47 THEN tcl:=1 END IF tcl=48 THEN tcl:=-2 END RETURN "";
END;
CHAR(Coor+tcl)END;
dat_inp(ID,xx,yy,xxx,yyy)BEGIN LOCAL Dato=dataVP_L(ID),Comun;
LOCAL NDato=STRING(Dato,1);
NDato▶Dato;
REPEAT RECT_P(xx,yy,xxx,yyy,0,#F4FA58);
TEXTOUT_P(NDato,xx+3,yy+2,2,#FF0040);
Coor:=WAIT(-1);
IF TYPE(Coor)=0 THEN CASE IF Coor=4 THEN NDato:=Dato;
END IF Coor=19 THEN IF DIM(NDato)≤1 THEN NDato:="" ELSE NDato:=LEFT(NDato,DIM(NDato)-1)END END NDato:=NDato+in_dat;
END ELSE IF SIZE(Coor)>1 AND NOT(TQ({xx,yy},{xxx,yyy}))THEN Comun:=1 END END;
IF Comun THEN IFERR EXPR(NDato)THEN NDato:=Dato;
END;
RECT_P(xx,yy,xxx,yyy,0,#FFFFFF);
TEXTOUT_P(NDato,xx+3,yy+2,2,0);
BREAK;
END UNTIL 0;
Dato:=EXPR(NDato);
dataVP_L(ID):=ROUND(Dato,3);
RECT_P(xx,yy,xxx,yyy,0,#FFFFFF);
TEXTOUT_P(STRING(dataVP_L(ID),1),xx+3,yy+2,2,0);
END;
time_dat BEGIN local mm,val,hor,minut;
mm:=Time;
mm:=HMS→(mm);
IF mm<12 THEN val:=" am";
ELSE val:=" pm";
END;
hor:=TRUNCATE(mm,0);
minut:=TRUNCATE((mm-TRUNCATE(mm,0))*60,0);
IF minut<10 THEN minut:="0"+minut;
END;
IF hor>12 THEN hor:=hor-12;
END;
BLIT_P(G1,270,0,320,8,G1,0,0,50,8);
textout_p(hor+":"+minut+val,G1,270,0,1,#E6E6E6);
END;
com_nd()BEGIN END;
ejecut()BEGIN RECT_P(G1,0,52,320,240);
LOCAL momenttt,mat_apoyo;
LOCAL N,B,k,nod,barraprop;
LOCAL dN,lN,nod,lB,lon,longi;
LOCAL ks,PE,PA,PI;
LOCAL rs,Krs,KR,Ka,Kb,Kc,Kd,Ss;
LOCAL val2:=carg_ines,val1:=carg_punt,val3:=mon_fl;
LOCAL qs1,ps,Vcor,Mflec,Pr,Lr;
LOCAL Ke,Kf,Kg,Prs,KFIN,PFIN;
LOCAL Dezp,reacc,DEF,FED,ult;
LOCAL TlB,ESFUERZO,lista_nod;
LOCAL GRAFFUERZA,qs2,rtl,lMM,nnd;
A:=dataVP(1);
lista_nod:=dataVP(15);
M5:=dataVP(16);
M2:=dataVP(17);
M1:=dataVP(19);
M0:=dataVP(18);
N:=MAKEMAT(0,SIZE(lista_nod),2);
mat_apoyo:=MAKEMAT(0,rowDim(N),2);
FOR k FROM 1 TO rowDim(N)DO N(k,1):=lista_nod(k);
mat_apoyo(k,1):=lista_nod(k);
END;
dN:=MAKEMAT(1,rowDim(N),3);
FOR k FROM 1 TO rowDim(M5)DO FOR nod FROM 1 TO rowDim(N)DO IF M5(k,1)=lista_nod(nod)THEN dN(nod,1):=M5(k,2);
dN(nod,2):=M5(k,3);
dN(nod,3):=M5(k,4);
END;
END;
END;
lN:=MAKEMAT(0,rowDim(N),3);
FOR k FROM 1 TO rowDim(M2)DO FOR nod FROM 1 TO rowDim(N)DO IF M2(k,1)=lista_nod(nod)THEN lN(nod,1):=M2(k,2);
END;
END;
END;
FOR k FROM 1 TO rowDim(M2)DO FOR nod FROM 1 TO rowDim(N)DO IF M2(k,1)=lista_nod(nod)THEN lN(nod,2):=M2(k,3);
END;
END;
END;
FOR k FROM 1 TO rowDim(M2)DO FOR nod FROM 1 TO rowDim(N)DO IF M2(k,1)=lista_nod(nod)THEN lN(nod,3):=M2(k,4);
END;
END;
END;
B:=MAKEMAT(0,rowDim(N)-1,7);
FOR k FROM 1 TO rowDim(N)-1 DO B(k,1):=lista_nod(k);
B(k,2):=lista_nod(k+1);
B(k,3):=M0(k,1);
B(k,4):=M0(k,2);
B(k,5):=M0(k,3);
B(k,6):=0;
B(k,7):=0;
END;
FOR k FROM 1 TO rowDim(M1)DO FOR nod FROM 1 TO rowDim(B)DO IF M1(k,1)=B(nod,1)AND M1(k,2)=B(nod,2)THEN B(nod,6):=M1(k,3);
B(nod,7):=M1(k,4);
END;
END;
END;
FOR k FROM 1 TO rowDim(N)-1 DO B(k,1):=k;
B(k,2):=k+1;
END;
M8:=B;
rtl:=MAKEMAT(0,rowDim(N),2);
FOR k FROM 1 TO rowDim(N)DO IF dN(k,1)=0 AND dN(k,2)=0 AND dN(k,3)=0 THEN rtl(k,2):=0;
mat_apoyo(k,2):=0;
END;
IF dN(k,1)=0 AND dN(k,2)=0 AND dN(k,3)=1 THEN rtl(k,2):=1;
mat_apoyo(k,2):=1;
END;
IF dN(k,1)=1 AND dN(k,2)=0 AND dN(k,3)=1 THEN rtl(k,2):=2;
mat_apoyo(k,2):=2;
END;
IF dN(k,1)=1 AND dN(k,2)=1 AND dN(k,3)=1 THEN rtl(k,2):=3;
mat_apoyo(k,2):=3;
END;
IF dN(k,1)=1 AND dN(k,2)=1 AND dN(k,3)=0 THEN rtl(k,2):=4;
mat_apoyo(k,2):=4;
END;
END;
lMM:=MAKEMAT(0,rowDim(B),2);
FOR k FROM 1 TO rowDim(B)DO FOR nnd FROM 1 TO rowDim(N)DO IF B(k,1)=nnd THEN lMM(k,1):=rtl(nnd,2);
END;
END;
END;
FOR k FROM 1 TO rowDim(B)DO FOR nnd FROM 1 TO rowDim(N)DO IF B(k,2)=nnd THEN lMM(k,2):=rtl(nnd,2);
END;
END;
END;
lB:=MAKEMAT(0,rowDim(B),6);
nod:=rowDim(N);
longi:=MAKEMAT(0,rowDim(B),4);
lon:=MAKEMAT(0,rowDim(B),1);
FOR k FROM 1 TO rowDim(B)DO FOR nnd FROM 1 TO rowDim(N)DO IF B(k,1)=nnd THEN longi(k,1):=N(nnd,1);
END;
END;
END;
FOR k FROM 1 TO rowDim(B)DO FOR nnd FROM 1 TO rowDim(N)DO IF B(k,2)=nnd THEN longi(k,2):=N(nnd,1);
END;
END;
END;
FOR k FROM 1 TO rowDim(B)DO lon(k,1):=longi(k,2)-longi(k,1);
END;
ks:=MAKEMAT(0,6,6);
rs:=MAKEMAT(0,6,6);
Ss:=MAKEMAT(0,nod*3,nod*3);
FOR k FROM 1 TO (nod-1)DO IF lMM(k,1)=4 AND lMM(k,2)=4 THEN ks(1,1):=((B(k,3)*B(k,4))/lon(k,1));
ks(4,4):=((B(k,3)*B(k,4))/lon(k,1));
ks(1,4):=-((B(k,3)*B(k,4))/lon(k,1));
ks(4,1):=-((B(k,3)*B(k,4))/lon(k,1));
ELSE IF lMM(k,1)≠4 AND lMM(k,2)=4 THEN ks(1,1):=((B(k,3)*B(k,4))/lon(k,1));
ks(4,4):=((B(k,3)*B(k,4))/lon(k,1));
ks(1,4):=-((B(k,3)*B(k,4))/lon(k,1));
ks(4,1):=-((B(k,3)*B(k,4))/lon(k,1));
ks(2,2):=(3*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(5,5):=(3*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(5,2):=(-3*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(2,5):=(-3*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(2,3):=(3*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(3,2):=(3*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(5,3):=(-3*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(3,5):=(-3*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(3,3):=(3*(B(k,3)*B(k,5))/lon(k,1));
ELSE IF lMM(k,1)=4 AND lMM(k,2)≠4 THEN ks(1,1):=((B(k,3)*B(k,4))/lon(k,1));
ks(4,4):=((B(k,3)*B(k,4))/lon(k,1));
ks(1,4):=-((B(k,3)*B(k,4))/lon(k,1));
ks(4,1):=-((B(k,3)*B(k,4))/lon(k,1));
ks(2,2):=(3*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(5,5):=(3*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(5,2):=(-3*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(2,5):=(-3*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(2,6):=(3*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(6,2):=(3*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(5,6):=(-3*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(6,5):=(-3*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(6,6):=(3*(B(k,3)*B(k,5))/lon(k,1));
ELSE ks(1,1):=((B(k,3)*B(k,4))/lon(k,1));
ks(4,4):=((B(k,3)*B(k,4))/lon(k,1));
ks(1,4):=-((B(k,3)*B(k,4))/lon(k,1));
ks(4,1):=-((B(k,3)*B(k,4))/lon(k,1));
ks(2,2):=(12*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(5,5):=(12*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(5,2):=(-12*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(2,5):=(-12*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(2,3):=(6*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(2,6):=(6*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(3,2):=(6*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(6,2):=(6*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(5,3):=(-6*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(5,6):=(-6*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(3,5):=(-6*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(6,5):=(-6*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(3,3):=(4*(B(k,3)*B(k,5))/lon(k,1));
ks(6,6):=(4*(B(k,3)*B(k,5))/lon(k,1));
ks(3,6):=(2*(B(k,3)*B(k,5))/lon(k,1));
ks(6,3):=(2*(B(k,3)*B(k,5))/lon(k,1));
END;
END;
END;
rs(1,1):=(longi(k,2)-longi(k,1))/lon(k,1);
rs(2,2):=(longi(k,2)-longi(k,1))/lon(k,1);
rs(4,4):=(longi(k,2)-longi(k,1))/lon(k,1);
rs(5,5):=(longi(k,2)-longi(k,1))/lon(k,1);
rs(1,2):=(longi(k,4)-longi(k,3))/lon(k,1);
rs(4,5):=(longi(k,4)-longi(k,3))/lon(k,1);
rs(2,1):=-(longi(k,4)-longi(k,3))/lon(k,1);
rs(5,4):=-(longi(k,4)-longi(k,3))/lon(k,1);
rs(3,3):=1;
rs(6,6):=1;
Krs:=TRN(rs)*ks*rs;
Ka:=SUB(Ss,{3*B(k,1)-2,3*B(k,1)-2},{3*B(k,1),3*B(k,1)})+SUB(Krs,{1,1},{3,3});
Kb:=SUB(Ss,{3*B(k,1)-2,3*B(k,2)-2},{3*B(k,1),3*B(k,2)})+SUB(Krs,{1,4},{3,6});
Kc:=SUB(Ss,{3*B(k,2)-2,3*B(k,2)-2},{3*B(k,2),3*B(k,2)})+SUB(Krs,{4,4},{6,6});
Kd:=SUB(Ss,{3*B(k,2)-2,3*B(k,1)-2},{3*B(k,2),3*B(k,1)})+SUB(Krs,{4,1},{6,3});
Ss(3*B(k,1)-2,3*B(k,1)-2):=Ka(1,1);
Ss(3*B(k,1)-2,3*B(k,1)-1):=Ka(1,2);
Ss(3*B(k,1)-2,3*B(k,1)):=Ka(1,3);
Ss(3*B(k,1)-1,3*B(k,1)-2):=Ka(2,1);
Ss(3*B(k,1)-1,3*B(k,1)-1):=Ka(2,2);
Ss(3*B(k,1)-1,3*B(k,1)):=Ka(2,3);
Ss(3*B(k,1),3*B(k,1)-2):=Ka(3,1);
Ss(3*B(k,1),3*B(k,1)-1):=Ka(3,2);
Ss(3*B(k,1),3*B(k,1)):=Ka(3,3);
Ss(3*B(k,1)-2,3*B(k,2)-2):=Kb(1,1);
Ss(3*B(k,1)-2,3*B(k,2)-1):=Kb(1,2);
Ss(3*B(k,1)-2,3*B(k,2)):=Kb(1,3);
Ss(3*B(k,1)-1,3*B(k,2)-2):=Kb(2,1);
Ss(3*B(k,1)-1,3*B(k,2)-1):=Kb(2,2);
Ss(3*B(k,1)-1,3*B(k,2)):=Kb(2,3);
Ss(3*B(k,1),3*B(k,2)-2):=Kb(3,1);
Ss(3*B(k,1),3*B(k,2)-1):=Kb(3,2);
Ss(3*B(k,1),3*B(k,2)):=Kb(3,3);
Ss(3*B(k,2)-2,3*B(k,2)-2):=Kc(1,1);
Ss(3*B(k,2)-2,3*B(k,2)-1):=Kc(1,2);
Ss(3*B(k,2)-2,3*B(k,2)):=Kc(1,3);
Ss(3*B(k,2)-1,3*B(k,2)-2):=Kc(2,1);
Ss(3*B(k,2)-1,3*B(k,2)-1):=Kc(2,2);
Ss(3*B(k,2)-1,3*B(k,2)):=Kc(2,3);
Ss(3*B(k,2),3*B(k,2)-2):=Kc(3,1);
Ss(3*B(k,2),3*B(k,2)-1):=Kc(3,2);
Ss(3*B(k,2),3*B(k,2)):=Kc(3,3);
Ss(3*B(k,2)-2,3*B(k,1)-2):=Kd(1,1);
Ss(3*B(k,2)-2,3*B(k,1)-1):=Kd(1,2);
Ss(3*B(k,2)-2,3*B(k,1)):=Kd(1,3);
Ss(3*B(k,2)-1,3*B(k,1)-2):=Kd(2,1);
Ss(3*B(k,2)-1,3*B(k,1)-1):=Kd(2,2);
Ss(3*B(k,2)-1,3*B(k,1)):=Kd(2,3);
Ss(3*B(k,2),3*B(k,1)-2):=Kd(3,1);
Ss(3*B(k,2),3*B(k,1)-1):=Kd(3,2);
Ss(3*B(k,2),3*B(k,1)):=Kd(3,3);
END;
Lr:=MAKEMAT(0,nod*3,1);
FOR k FROM 1 TO rowDim(lB)DO qs1:=B(k,6);
qs2:=B(k,7);
IF lMM(k,1)=4 AND lMM(k,2)=4 THEN IF qs1 ≠ 0 AND qs2≠0 THEN IF qs1=qs2 THEN lB(k,2):=(-qs1*lon(k,1))/2;
lB(k,5):=(-qs1*lon(k,1))/2;
lB(k,3):=0;
lB(k,6):=0;
END;
IF ABS(qs1)<ABS(qs2)THEN lB(k,2):=-(((3*qs2*lon(k,1))/20)+((7*qs1*lon(k,1))/20));
lB(k,5):=-(((7*qs2*lon(k,1))/20)+((3*qs1*lon(k,1))/20));
lB(k,3):=0;
lB(k,6):=0;
END;
IF ABS(qs2)<ABS(qs1)THEN lB(k,2):=-(((7*qs1*lon(k,1))/20)+((3*qs2*lon(k,1))/20));
lB(k,5):=-(((3*qs1*lon(k,1))/20)+((7*qs2*lon(k,1))/20));
lB(k,3):=0;
lB(k,6):=0;
END;
END;
IF qs1=0 AND qs2≠0 THEN lB(k,2):=(-3*qs2*lon(k,1))/20;
lB(k,5):=(-7*qs2*lon(k,1))/20;
lB(k,3):=0;
lB(k,6):=0;
END;
IF qs1 ≠ 0 AND qs2=0 THEN lB(k,2):=(-7*qs1*lon(k,1))/20;
lB(k,5):=(-3*qs1*lon(k,1))/20;
lB(k,3):=0;
lB(k,6):=0;
END;
ELSE IF lMM(k,1)=4 AND lMM(k,2)≠4 THEN IF qs1 ≠ 0 AND qs2≠0 THEN IF qs1=qs2 THEN lB(k,2):=(-3*qs1*lon(k,1))/8;
lB(k,5):=(-5*qs1*lon(k,1))/8;
lB(k,3):=0;
lB(k,6):=(qs1*lon(k,1)^2)/8;
END;
IF ABS(qs1)<ABS(qs2)THEN lB(k,2):=-((3*qs1*lon(k,1))/8)-(((qs2-qs1)*lon(k,1))/10);
lB(k,5):=-((5*qs1*lon(k,1))/8)-((2*(qs2-qs1)*lon(k,1))/5);
lB(k,3):=0;
lB(k,6):=((qs1*lon(k,1)^2)/8)+(((qs2-qs1)*lon(k,1)^2)/15);
END;
IF ABS(qs2)<ABS(qs1)THEN lB(k,2):=-((3*qs2*lon(k,1))/8)-((11*(qs1-qs2)*lon(k,1))/40);
lB(k,5):=-((5*qs2*lon(k,1))/8)-((9*(qs1-qs2)*lon(k,1))/40);
lB(k,3):=0;
lB(k,6):=((qs2*lon(k,1)^2)/8)+((7*(qs1-qs2)*lon(k,1)^2)/120);
END;
END;
IF qs1=0 AND qs2≠0 THEN lB(k,2):=(-qs2*lon(k,1))/10;
lB(k,5):=(-2*qs2*lon(k,1))/5;
lB(k,3):=0;
lB(k,6):=(qs2*lon(k,1)^2)/15;
END;
IF qs1 ≠ 0 AND qs2=0 THEN lB(k,2):=(-11*qs1*lon(k,1))/40;
lB(k,5):=(-9*qs1*lon(k,1))/40;
lB(k,3):=0;
lB(k,6):=(7*qs1*lon(k,1)^2)/120;
END;
ELSE IF lMM(k,1)≠4 AND lMM(k,2)=4 THEN IF qs1 ≠ 0 AND qs2≠0 THEN IF qs1=qs2 THEN lB(k,2):=(-5*qs1*lon(k,1))/8;
lB(k,5):=(-3*qs1*lon(k,1))/8;
lB(k,3):=-(qs1*lon(k,1)^2)/8;
lB(k,6):=0;
END;
IF ABS(qs1)<ABS(qs2)THEN lB(k,2):=-((5*qs1*lon(k,1))/8)-((9*(qs2-qs1)*lon(k,1))/40);
lB(k,5):=-((3*qs1*lon(k,1))/8)-((11*(qs2-qs1)*lon(k,1))/40);
lB(k,3):=-((qs1*lon(k,1)^2)/8)-((7*(qs2-qs1)*lon(k,1)^2)/120);
lB(k,6):=0;
END;
IF ABS(qs2)<ABS(qs1)THEN lB(k,2):=-((5*qs2*lon(k,1))/8)-((2*(qs1-qs2)*lon(k,1))/5);
lB(k,5):=-((3*qs2*lon(k,1))/8)-(((qs1-qs2)*lon(k,1))/10);
lB(k,3):=-((qs2*lon(k,1)^2)/8)-(((qs1-qs2)*lon(k,1)^2)/15);
lB(k,6):=0;
END;
END;
IF qs1=0 AND qs2≠0 THEN lB(k,2):=(-9*qs2*lon(k,1))/40;
lB(k,5):=(-11*qs2*lon(k,1))/40;
lB(k,3):=-(7*qs2*lon(k,1)^2)/120;
lB(k,6):=0;
END;
IF qs1 ≠ 0 AND qs2=0 THEN lB(k,2):=(-2*qs1*lon(k,1))/5;
lB(k,5):=(-qs1*lon(k,1))/10;
lB(k,3):=-(qs1*lon(k,1)^2)/15;
lB(k,6):=0;
END;
ELSE IF qs1 ≠ 0 AND qs2≠0 THEN IF qs1=qs2 THEN lB(k,2):=(-qs1*lon(k,1))/2;
lB(k,5):=(-qs1*lon(k,1))/2;
lB(k,3):=(-qs1*lon(k,1)^2)/12;
lB(k,6):=(qs1*lon(k,1)^2)/12;
END;
IF ABS(qs1)<ABS(qs2)THEN lB(k,2):=-(((3*qs2*lon(k,1))/20)+((7*qs1*lon(k,1))/20));
lB(k,5):=-(((7*qs2*lon(k,1))/20)+((3*qs1*lon(k,1))/20));
lB(k,3):=-(((qs2*lon(k,1)^2)/30)+((qs1*lon(k,1)^2)/20));
lB(k,6):=(((qs2*lon(k,1)^2)/20)+((qs1*lon(k,1)^2)/30));
END;
IF ABS(qs2)<ABS(qs1)THEN lB(k,2):=-(((7*qs1*lon(k,1))/20)+((3*qs2*lon(k,1))/20));
lB(k,5):=-(((3*qs1*lon(k,1))/20)+((7*qs2*lon(k,1))/20));
lB(k,3):=-(((qs1*lon(k,1)^2)/20)+((qs2*lon(k,1)^2)/30));
lB(k,6):=(((qs1*lon(k,1)^2)/30)+((qs2*lon(k,1)^2)/20));
END;
END;
IF qs1=0 AND qs2≠0 THEN lB(k,2):=(-3*qs2*lon(k,1))/20;
lB(k,5):=(-7*qs2*lon(k,1))/20;
lB(k,3):=(-qs2*lon(k,1)^2)/30;
lB(k,6):=(qs2*lon(k,1)^2)/20;
END;
IF qs1 ≠ 0 AND qs2=0 THEN lB(k,2):=(-7*qs1*lon(k,1))/20;
lB(k,5):=(-3*qs1*lon(k,1))/20;
lB(k,3):=(-qs1*lon(k,1)^2)/20;
lB(k,6):=(qs1*lon(k,1)^2)/30;
END;
END;
END;
END;
ps:=TRN(row(lB,k));
Pr:=-(TRN(rs)*ps);
Ke:=SUB(Lr,{3*B(k,1)-2,1},{3*B(k,1),1})+SUB(Pr,{1,1},{3,1});
Kf:=SUB(Lr,{3*B(k,2)-2,1},{3*B(k,2),1})+SUB(Pr,{4,1},{6,1});
Lr(3*B(k,1)-2,1):=Ke(1,1);
Lr(3*B(k,1)-1,1):=Ke(2,1);
Lr(3*B(k,1),1):=Ke(3,1);
Lr(3*B(k,2)-2,1):=Kf(1,1);
Lr(3*B(k,2)-1,1):=Kf(2,1);
Lr(3*B(k,2),1):=Kf(3,1);
END;
FOR k FROM 1 TO rowDim(lN)DO Prs:=TRN(row(lN,k));
Kg:=SUB(Lr,{3*k-2,1},{3*k,1})+SUB(Prs,{1,1},{3,1});
Lr(3*k-2,1):=Kg(1,1);
Lr(3*k-1,1):=Kg(2,1);
Lr(3*k,1):=Kg(3,1);
END;
KFIN:=Ss;
PFIN:=Lr;
FOR k FROM 1 TO rowDim(dN)DO IF dN(k,1)==0 THEN ADDROW(Ss,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],3*k-2);
DELROW(Ss,3*k-1);
ADDCOL(Ss,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],3*k-2);
DELCOL(Ss,3*k-1);
Lr(3*k-2,1):=0;
Ss(3*k-2,3*k-2):=1;
END;
IF dN(k,2)==0 THEN ADDROW(Ss,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],3*k-1);
DELROW(Ss,3*k);
ADDCOL(Ss,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],3*k-1);
DELCOL(Ss,3*k);
Lr(3*k-1,1):=0;
Ss(3*k-1,3*k-1):=1;
END;
IF dN(k,3)==0 THEN ADDROW(Ss,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],3*k);
DELROW(Ss,3*k+1);
ADDCOL(Ss,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],3*k);
DELCOL(Ss,3*k+1);
Lr(3*k,1):=0;
Ss(3*k,3*k):=1;
END;
END;
FOR k FROM 1 TO rowDim(Ss)DO IF Ss(k,k)==0 THEN Ss(k,k):=1;
END;
END;
Dezp:=(inv(Ss)*Lr);
reacc:=KFIN*Dezp-PFIN;
reacc:=ROUND(reacc,3);
FOR k FROM 1 TO rowDim(dN)DO IF dN(k,1)==1 AND dN(k,2)==1 AND dN(k,3)==0 THEN reacc(3*k,1):=0;
END;
END;
DEF:=MAKEMAT(0,6,1);
FED:=MAKEMAT(0,6,rowDim(B));
FOR k FROM 1 TO rowDim(B)DO DEF(1,1):=Dezp(3*B(k,1)-2,1);
DEF(2,1):=Dezp(3*B(k,1)-1,1);
DEF(3,1):=Dezp(3*B(k,1),1);
DEF(4,1):=Dezp(3*B(k,2)-2,1);
DEF(5,1):=Dezp(3*B(k,2)-1,1);
DEF(6,1):=Dezp(3*B(k,2),1);
rs(1,1):=(longi(k,2)-longi(k,1))/lon(k,1);
rs(2,2):=(longi(k,2)-longi(k,1))/lon(k,1);
rs(4,4):=(longi(k,2)-longi(k,1))/lon(k,1);
rs(5,5):=(longi(k,2)-longi(k,1))/lon(k,1);
rs(1,2):=(longi(k,4)-longi(k,3))/lon(k,1);
rs(4,5):=(longi(k,4)-longi(k,3))/lon(k,1);
rs(2,1):=-(longi(k,4)-longi(k,3))/lon(k,1);
rs(5,4):=-(longi(k,4)-longi(k,3))/lon(k,1);
rs(3,3):=1;
rs(6,6):=1;
DEF:=rs*DEF;
IF lMM(k,1)=4 AND lMM(k,2)=4 THEN ks(1,1):=((B(k,3)*B(k,4))/lon(k,1));
ks(4,4):=((B(k,3)*B(k,4))/lon(k,1));
ks(1,4):=-((B(k,3)*B(k,4))/lon(k,1));
ks(4,1):=-((B(k,3)*B(k,4))/lon(k,1));
ELSE IF lMM(k,1)≠4 AND lMM(k,2)=4 THEN ks(1,1):=((B(k,3)*B(k,4))/lon(k,1));
ks(4,4):=((B(k,3)*B(k,4))/lon(k,1));
ks(1,4):=-((B(k,3)*B(k,4))/lon(k,1));
ks(4,1):=-((B(k,3)*B(k,4))/lon(k,1));
ks(2,2):=(3*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(5,5):=(3*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(5,2):=(-3*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(2,5):=(-3*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(2,3):=(3*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(3,2):=(3*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(5,3):=(-3*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(3,5):=(-3*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(3,3):=(3*(B(k,3)*B(k,5))/lon(k,1));
ELSE IF lMM(k,1)=4 AND lMM(k,2)≠4 THEN ks(1,1):=((B(k,3)*B(k,4))/lon(k,1));
ks(4,4):=((B(k,3)*B(k,4))/lon(k,1));
ks(1,4):=-((B(k,3)*B(k,4))/lon(k,1));
ks(4,1):=-((B(k,3)*B(k,4))/lon(k,1));
ks(2,2):=(3*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(5,5):=(3*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(5,2):=(-3*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(2,5):=(-3*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(2,6):=(3*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(6,2):=(3*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(5,6):=(-3*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(6,5):=(-3*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(6,6):=(3*(B(k,3)*B(k,5))/lon(k,1));
ELSE ks(1,1):=((B(k,3)*B(k,4))/lon(k,1));
ks(4,4):=((B(k,3)*B(k,4))/lon(k,1));
ks(1,4):=-((B(k,3)*B(k,4))/lon(k,1));
ks(4,1):=-((B(k,3)*B(k,4))/lon(k,1));
ks(2,2):=(12*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(5,5):=(12*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(5,2):=(-12*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(2,5):=(-12*(B(k,3)*B(k,5))/lon(k,1)^3);
ks(2,3):=(6*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(2,6):=(6*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(3,2):=(6*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(6,2):=(6*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(5,3):=(-6*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(5,6):=(-6*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(3,5):=(-6*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(6,5):=(-6*(B(k,3)*B(k,5))/lon(k,1)^2);
ks(3,3):=(4*(B(k,3)*B(k,5))/lon(k,1));
ks(6,6):=(4*(B(k,3)*B(k,5))/lon(k,1));
ks(3,6):=(2*(B(k,3)*B(k,5))/lon(k,1));
ks(6,3):=(2*(B(k,3)*B(k,5))/lon(k,1));
END;
END;
END;
ult:=ks*DEF;
FED(1,k):=ult(1,1);
FED(2,k):=ult(2,1);
FED(3,k):=ult(3,1);
FED(4,k):=ult(4,1);
FED(5,k):=ult(5,1);
FED(6,k):=ult(6,1);
TlB:=TRN(row(lB,k));
FED(1,k):=FED(1,k)+TlB(1,1);
FED(2,k):=FED(2,k)+TlB(2,1);
FED(3,k):=FED(3,k)+TlB(3,1);
FED(4,k):=FED(4,k)+TlB(4,1);
FED(5,k):=FED(5,k)+TlB(5,1);
FED(6,k):=FED(6,k)+TlB(6,1);
END;
ESFUERZO:=TRN(FED);
FOR k FROM 1 TO rowDim(lMM)DO IF lMM(k,1)==4 THEN ESFUERZO(k,3):=0;
END;
IF lMM(k,2)==4 THEN ESFUERZO(k,6):=0;
END;
END;
FOR k FROM 1 TO rowDim(B)DO IF ESFUERZO(k,1)<0.00005 THEN ESFUERZO(k,1):=0;
END;
IF-0.00005<ESFUERZO(k,2)<0.00005 THEN ESFUERZO(k,2):=0;
END;
IF-0.00005<ESFUERZO(k,3)<0.00005 THEN ESFUERZO(k,3):=0;
END;
IF-0.00005<ESFUERZO(k,4)<0.00005 THEN ESFUERZO(k,4):=0;
END;
IF-0.00005< ESFUERZO(k,5)<0.00005 THEN ESFUERZO(k,5):=0;
END;
IF-0.00005<ESFUERZO(k,6)<0.00005 THEN ESFUERZO(k,6):=0;
END;
END;
LINE(G1,-13,-2,13,-2,#DBA901h);
line_p(G1,5,220,5,238,#0040FF);
line_p(G1,2,235,20,235,#086A87);
textout_p("kN",G1,4,209,1,#0040FF);
textout_p("mm",G1,7,224,1,#086A87);
textout_p("▲",G1,2,215,2,#0040FF);
textout_p("▶",G1,17,230,2,#086A87);
line_p(G1,30,221,290,221,#848484);
line_p(G1,30,235,290,235,#04B4AE);
for k from 1 to A do line_p(G1,30+k*(260/A),233,30+k*(260/A),237,#04B4AE);
end;
for k from 1 to rowDim(mat_apoyo)do line_p(G1,30+mat_apoyo(k,1)*(260/A),216,30+mat_apoyo(k,1)*(260/A),225,#848484);
line_p(G1,26+mat_apoyo(k,1)*(260/A),218,34+mat_apoyo(k,1)*(260/A),223,#848484);
textout_p(mat_apoyo(k,1),G1,26+mat_apoyo(k,1)*(260/A),231,1,0,100,#FFFFFF);
end;
for k from 1 to rowDim(mat_apoyo)-1 do textout_p(lon(k,1),G1,25+(mat_apoyo(k,1)+(lon(k,1)/2))*(260/A),223,1,#848484);
end;
local ffig:=dataVP(21);
local fcarg:=dataVP(22);
local fapy:=dataVP(23);
local fcort:=dataVP(24);
local fmome:=dataVP(25);
IF ffig=0 THEN ELSE line_p(G1,30,129,290,129,#2E2E2E);
line_p(G1,30,130,290,130,#2E2E2E);
line_p(G1,30,131,290,131,#2E2E2E);
for k from 1 to rowDim(N)do if mat_apoyo(k,2)=0 then if mat_apoyo(k,1)>0 then textout_p("▒",G1,291,126,1,#086A87);
textout_p("▒",G1,291,126,1,#086A87);
end;
if mat_apoyo(k,1)=0 then textout_p("▒",G1,24,126,1,#086A87);
textout_p("▒",G1,24,126,1,#086A87);
end;
end;
if mat_apoyo(k,2)=1 then textout_p("︿",G1,20+mat_apoyo(k,1)*(260/A),118,7,#086A87);
textout_p("—",G1,22+mat_apoyo(k,1)*(260/A),124,5,#086A87);
textout_p("—",G1,22+mat_apoyo(k,1)*(260/A),126,5,#086A87);
textout_p("—",G1,22+mat_apoyo(k,1)*(260/A),127,5,#086A87);
end;
if mat_apoyo(k,2)=2 then textout_p("︿",G1,20+mat_apoyo(k,1)*(260/A),118,7,#086A87);
textout_p("—",G1,22+mat_apoyo(k,1)*(260/A),124,5,#086A87);
textout_p("●●●",G1,22+mat_apoyo(k,1)*(260/A),135,1,#086A87);
end;
if mat_apoyo(k,2)=4 then textout_p("●",G1,25+mat_apoyo(k,1)*(260/A),119,5,#FFFFFF);
textout_p("●",G1,27+mat_apoyo(k,1)*(260/A),126,1,#086A87);
end;
end;
END;
IF fcarg=0 THEN ELSE LOCAL ADDAPOYO,k,MAX_Y,rango,RANGO_Y,RANGO_Z;
LOCAL rango1,rango2,dimencar,n;
MAX_Y:=(M1(-3));
MAX_Y:=TRN(MAX_Y);
rango1:=maxnorm((MAX_Y));
MAX_Y:=(M1(-4));
MAX_Y:=TRN(MAX_Y);
rango2:=maxnorm((MAX_Y));
IF rango1<rango2 THEN RANGO_Y:=rango2/5.5;
ELSE RANGO_Y:=rango1/5.5;
END;
IF rango1=rango2 THEN RANGO_Y:=rango1/5.5;
END;
FOR k FROM 1 TO rowDim(M1)DO B:=M1(k,1);
W:=M1(k,2);
X:=M1(k,3);
Y:=M1(k,4);
dimencar:=(W-B);
dimencar:=dimencar*5*(26/A);
IF M1(k,3)≠ 0 AND M1(k,4)≠0 THEN IF M1(k,3)=M1(k,4)THEN IF M1(k,3)<0 THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2+ABS(X)/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2+ABS(X)/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+((W+B)/2)*(26/A),-2+0.9+ABS(X)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2+ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2+ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-1.7,-12.8+B*(26/A),-1.7,-13+B*(26/A),-1.9,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-1.7,-12.8+W*(26/A),-1.7,-13+W*(26/A),-1.9,#0080FFh);
END;
IF 0<M1(k,3)THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2-ABS(X)/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2-ABS(X)/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+((W+B)/2)*(26/A),-3.1+0.9-ABS(X)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2-ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2-ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-2.3,-12.8+B*(26/A),-2.3,-13+B*(26/A),-2.1,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-2.3,-12.8+W*(26/A),-2.3,-13+W*(26/A),-2.1,#0080FFh);
END;
END;
IF ABS(M1(k,3))<ABS(M1(k,4))THEN IF M1(k,3)<0 AND M1(k,4)<0 THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2+ABS(X)/RANGO_Y+(ABS(Y)-ABS(X))*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2+ABS(X)/RANGO_Y+(ABS(Y)-ABS(X))*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+B*(26/A),-2+0.9+ABS(X)/RANGO_Y,1,#0080FFh,100);
TEXTOUT(ABS(Y),G1,-13+W*(26/A),-2+0.9+ABS(Y)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2+ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2+ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-1.7,-12.8+B*(26/A),-1.7,-13+B*(26/A),-1.9,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-1.7,-12.8+W*(26/A),-1.7,-13+W*(26/A),-1.9,#0080FFh);
END;
IF 0<M1(k,3)AND 0<M1(k,4)THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2-ABS(X)/RANGO_Y-(ABS(Y)-ABS(X))*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2-ABS(X)/RANGO_Y-(ABS(Y)-ABS(X))*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+B*(26/A),-3.1+0.9-ABS(X)/RANGO_Y,1,#0080FFh,100);
TEXTOUT(ABS(Y),G1,-13+W*(26/A),-3.1+0.9-ABS(Y)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2-ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2-ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-2.3,-12.8+B*(26/A),-2.3,-13+B*(26/A),-2.1,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-2.3,-12.8+W*(26/A),-2.3,-13+W*(26/A),-2.1,#0080FFh);
END;
END;
IF ABS(M1(k,4))< ABS(M1(k,3))THEN IF M1(k,3)<0 AND M1(k,4)<0 THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2+ABS(Y)/RANGO_Y+(ABS(X)-ABS(Y))*(((W-B)-(0.5*n*A/(5*26)))/(W-B))/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2+ABS(Y)/RANGO_Y+(ABS(X)-ABS(Y))*(((W-B)-(0.5*n*A/(5*26)))/(W-B))/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+B*(26/A),-2+0.9+ABS(X)/RANGO_Y,1,#0080FFh,100);
TEXTOUT(ABS(Y),G1,-13+W*(26/A),-2+0.9+ABS(Y)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2+ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2+ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-1.7,-12.8+B*(26/A),-1.7,-13+B*(26/A),-1.9,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-1.7,-12.8+W*(26/A),-1.7,-13+W*(26/A),-1.9,#0080FFh);
END;
IF 0<M1(k,3)AND 0<M1(k,4)THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2-ABS(Y)/RANGO_Y-(ABS(X)-ABS(Y))*(((W-B)-(0.5*n*A/(5*26)))/(W-B))/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2-ABS(Y)/RANGO_Y-(ABS(X)-ABS(Y))*(((W-B)-(0.5*n*A/(5*26)))/(W-B))/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+B*(26/A),-3.1+0.9-ABS(X)/RANGO_Y,1,#0080FFh,100);
TEXTOUT(ABS(Y),G1,-13+W*(26/A),-3.1+0.9-ABS(Y)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2-ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2-ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-2.3,-12.8+B*(26/A),-2.3,-13+B*(26/A),-2.1,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-2.3,-12.8+W*(26/A),-2.3,-13+W*(26/A),-2.1,#0080FFh);
END;
END;
END;
IF M1(k,3)≠ 0 AND M1(k,4)=0 THEN IF M1(k,3)<0 THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2+ABS(X)/RANGO_Y-ABS(X)*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2+ABS(X)/RANGO_Y-ABS(X)*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+B*(26/A),-2+0.9+ABS(X)/RANGO_Y,1,#0080FFh,100);
TEXTOUT(ABS(Y),G1,-13+W*(26/A),-2+0.9+ABS(Y)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2+ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2+ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-1.7,-12.8+B*(26/A),-1.7,-13+B*(26/A),-1.9,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-1.7,-12.8+W*(26/A),-1.7,-13+W*(26/A),-1.9,#0080FFh);
END;
IF 0<M1(k,3)THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2-ABS(X)/RANGO_Y+ABS(X)*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2-ABS(X)/RANGO_Y+ABS(X)*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+B*(26/A),-3.1+0.9-ABS(X)/RANGO_Y,1,#0080FFh,100);
TEXTOUT(ABS(Y),G1,-13+W*(26/A),-3.1+0.9-ABS(Y)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2-ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2-ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-2.3,-12.8+B*(26/A),-2.3,-13+B*(26/A),-2.1,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-2.3,-12.8+W*(26/A),-2.3,-13+W*(26/A),-2.1,#0080FFh);
END;
END;
IF M1(k,3)=0 AND M1(k,4)≠0 THEN IF M1(k,4)<0 THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2+ABS(X)/RANGO_Y+ABS(Y)*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2+ABS(X)/RANGO_Y+ABS(Y)*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+B*(26/A),-2+0.9+ABS(X)/RANGO_Y,1,#0080FFh,100);
TEXTOUT(ABS(Y),G1,-13+W*(26/A),-2+0.9+ABS(Y)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2+ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2+ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-1.7,-12.8+B*(26/A),-1.7,-13+B*(26/A),-1.9,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-1.7,-12.8+W*(26/A),-1.7,-13+W*(26/A),-1.9,#0080FFh);
END;
IF 0<M1(k,4)THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+B*(26/A),-2-ABS(X)/RANGO_Y-ABS(Y)*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1*n+B*(26/A),-2,{#0080FFh,200});
PIXON(G1,-13+0.1*n+B*(26/A),-2-ABS(X)/RANGO_Y-ABS(Y)*((0.5*n*A/(5*26))/(W-B))/RANGO_Y,#0080FFh);
END;
TEXTOUT(ABS(X),G1,-13+B*(26/A),-3.1+0.9-ABS(X)/RANGO_Y,1,#0080FFh,100);
TEXTOUT(ABS(Y),G1,-13+W*(26/A),-3.1+0.9-ABS(Y)/RANGO_Y,1,#0080FFh,100);
LINE(G1,-13+B*(26/A),-2,-13+B*(26/A),-2-ABS(X)/RANGO_Y,#0080FFh);
LINE(G1,-13+W*(26/A),-2,-13+W*(26/A),-2-ABS(Y)/RANGO_Y,#0080FFh);
TRIANGLE(G1,-13.2+B*(26/A),-2.3,-12.8+B*(26/A),-2.3,-13+B*(26/A),-2.1,#0080FFh);
TRIANGLE(G1,-13.2+W*(26/A),-2.3,-12.8+W*(26/A),-2.3,-13+W*(26/A),-2.1,#0080FFh);
END;
END;
END;
FOR k FROM 1 TO rowDim(M1)DO B:=M1(k,1);
W:=M1(k,2);
X:=M1(k,3);
Y:=M1(k,4);
dimencar:=(W-B);
dimencar:=dimencar*5*(26/A);
IF M1(k,3)≠ 0 AND M1(k,4)≠0 THEN IF M1(k,3)=M1(k,4)THEN IF M1(k,3)<0 THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2+ABS(X)/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-1.7,-12.7+0.8*n+B*(26/A),-1.7,-12.9+0.8*n+B*(26/A),-1.9,#0080FFh);
END;
END;
IF 0<M1(k,3)THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2-ABS(X)/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-2.3,-12.7+0.8*n+B*(26/A),-2.3,-12.9+0.8*n+B*(26/A),-2.1,#0080FFh);
END;
END;
END;
IF ABS(M1(k,3))<ABS(M1(k,4))THEN IF M1(k,3)<0 AND M1(k,4)<0 THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2+ABS(X)/RANGO_Y+(ABS(Y)-ABS(X))*(((4*n*A/(5*26)))/(W-B))/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-1.7,-12.7+0.8*n+B*(26/A),-1.7,-12.9+0.8*n+B*(26/A),-1.9,#0080FFh);
END;
END;
IF 0<M1(k,3)AND 0<M1(k,4)THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2-ABS(X)/RANGO_Y-(ABS(Y)-ABS(X))*(((4*n*A/(5*26)))/(W-B))/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-2.3,-12.7+0.8*n+B*(26/A),-2.3,-12.9+0.8*n+B*(26/A),-2.1,#0080FFh);
END;
END;
END;
IF ABS(M1(k,4))< ABS(M1(k,3))THEN IF M1(k,3)<0 AND M1(k,4)<0 THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2+ABS(Y)/RANGO_Y+(ABS(X)-ABS(Y))*(((W-B)-(4*n*A/(5*26)))/(W-B))/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-1.7,-12.7+0.8*n+B*(26/A),-1.7,-12.9+0.8*n+B*(26/A),-1.9,#0080FFh);
END;
END;
IF 0<M1(k,3)AND 0<M1(k,4)THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2-ABS(Y)/RANGO_Y-(ABS(X)-ABS(Y))*(((W-B)-(4*n*A/(5*26)))/(W-B))/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-2.3,-12.7+0.8*n+B*(26/A),-2.3,-12.9+0.8*n+B*(26/A),-2.1,#0080FFh);
END;
END;
END;
END;
IF M1(k,3)≠ 0 AND M1(k,4)=0 THEN IF M1(k,3)<0 THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2+ABS(X)/RANGO_Y-ABS(X)*((4*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-1.7,-12.7+0.8*n+B*(26/A),-1.7,-12.9+0.8*n+B*(26/A),-1.9,#0080FFh);
END;
END;
IF 0<M1(k,3)THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2-ABS(X)/RANGO_Y+ABS(X)*((4*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-2.3,-12.7+0.8*n+B*(26/A),-2.3,-12.9+0.8*n+B*(26/A),-2.1,#0080FFh);
END;
END;
END;
IF M1(k,3)=0 AND M1(k,4)≠0 THEN IF M1(k,4)<0 THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2+ABS(X)/RANGO_Y+ABS(Y)*((4*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-1.7,-12.7+0.8*n+B*(26/A),-1.7,-12.9+0.8*n+B*(26/A),-1.9,#0080FFh);
END;
END;
IF 0<M1(k,4)THEN FOR n FROM 1 TO dimencar/4 DO LINE(G1,-13+0.1+0.8*n+B*(26/A),-2-ABS(X)/RANGO_Y-ABS(Y)*((4*n*A/(5*26))/(W-B))/RANGO_Y,-13+0.1+0.8*n+B*(26/A),-2,#0080FFh);
TRIANGLE(G1,-13.1+0.8*n+B*(26/A),-2.3,-12.7+0.8*n+B*(26/A),-2.3,-12.9+0.8*n+B*(26/A),-2.1,#0080FFh);
END;
END;
END;
END;
LOCAL ADDAPOYO,k,MAX_Y,rango,RANGO_Y,RANGO_Z;
MAX_Y:=(M2(-3));
MAX_Y:=TRN(MAX_Y);
rango:=maxnorm((MAX_Y));
RANGO_Y:=rango/6;
FOR k FROM 1 TO rowDim(M2)DO IF 0<=M2(k,1)<=A THEN IF M2(k,3)<0 THEN TRIANGLE(G1,-13.2+M2(k,1)*(26/A),-1.7,-12.8+M2(k,1)*(26/A),-1.7,-13+M2(k,1)*(26/A),-1.9,#FF8000h);
LINE(G1,-13+M2(k,1)*(26/A),-2+ABS(M2(k,3))/RANGO_Y,-13+M2(k,1)*(26/A),-2,#FF8000h);
TEXTOUT(ABS(M2(k,3)),G1,-13.7+M2(k,1)*(26/A),-2+0.9+ABS(M2(k,3))/RANGO_Y,1,#FF8000h,100);
END;
IF 0<M2(k,3)THEN TRIANGLE(G1,-13.2+M2(k,1)*(26/A),-2.3,-12.8+M2(k,1)*(26/A),-2.3,-13+M2(k,1)*(26/A),-2.1,#FF8000h);
LINE(G1,-13+M2(k,1)*(26/A),-2,-13+M2(k,1)*(26/A),-2-ABS(M2(k,3))/RANGO_Y,#FF8000h);
TEXTOUT(ABS(M2(k,3)),G1,-13.7+M2(k,1)*(26/A),-3.1+0.9-ABS(M2(k,3))/RANGO_Y,1,#FF8000h,100);
END;
END;
END;
FOR k FROM 1 TO rowDim(M2)DO IF 0<=M2(k,1)<=A THEN IF M2(k,4)<0 THEN TEXTOUT("↻",G1,-13.7+M2(k,1)*(26/A),-1.3,3,#FF00FFh,100);
TEXTOUT(M2(k,4),G1,-12.4+M2(k,1)*(26/A),-2.3,1,#FF00FFh,100);
END;
IF 0<M2(k,4)THEN TEXTOUT("↺",G1,-13.7+M2(k,1)*(26/A),-1.3,3,#FF00FFh,100);
TEXTOUT(M2(k,4),G1,-12.4+M2(k,1)*(26/A),-2.3,1,#FF00FFh,100);
END;
END;
END;
FOR k FROM 1 TO rowDim(M2)DO IF 0<=M2(k,1)<=A THEN IF M2(k,2)<0 THEN TEXTOUT("←",G1,-13.1+M2(k,1)*(26/A),-1.1,3,#01DF01h,100);
TEXTOUT(M2(k,2),G1,-14+M2(k,1)*(26/A),-2.5,1,#01DF01h,100);
END;
IF 0<M2(k,2)THEN TEXTOUT("→",G1,-14+M2(k,1)*(26/A),-1.1,3,#01DF01h,100);
TEXTOUT(M2(k,2),G1,-14+M2(k,1)*(26/A),-2.5,1,#01DF01h,100);
END;
END;
END;
END;
IF fapy=0 THEN ELSE LOCAL REACIONNN;
REACIONNN:=reacc;
FOR k FROM 1 TO rowDim(N)DO IF 0<reacc(3*k-1,1)THEN TEXTOUT("↑",G1,-13.18+N(k,1)*(26/A),-3,3,#FE2E64h,100);
TEXTOUT(REACIONNN(3*k-1,1),G1,-13.6+N(k,1)*(26/A),-4.8,1,#2E64FE,100);
END;
IF reacc(3*k-1,1)<0 THEN TEXTOUT("↓",G1,-13.18+N(k,1)*(26/A),-3,3,#FE2E64h,100);
TEXTOUT(-REACIONNN(3*k-1,1),G1,-13.6+N(k,1)*(26/A),-4.8,1,#2E64FE,100);
END;
IF 0.001<reacc(3*k,1)THEN TEXTOUT("↶",G1,-13.7+N(k,1)*(26/A),-0.2,3,#FE2E64h,100);
TEXTOUT(REACIONNN(3*k,1),G1,-13.6+N(k,1)*(26/A),0.1,1,#2E64FE,100);
END;
IF reacc(3*k,1)<-0.001 THEN TEXTOUT("↷",G1,-13.7+N(k,1)*(26/A),-0.2,3,#FE2E64h,100);
TEXTOUT(REACIONNN(3*k,1),G1,-13.6+N(k,1)*(26/A),0.1,1,#2E64FE,100);
END;
END;
END;
IF fcort=0 THEN ELSE LOCAL dimencar,n,rango2,GRAFFUERZA;
LOCAL MAX_Y,rango,RANGO_Y,color,MOMENTOSS,ESFUERZOCER;
color:={"#04B4AEh","#5FB404h","#31B404h","#3ADF00h","#01DF3Ah","#01DFA5h","#01A9DBh","#642EFEh","#9A2EFEh","#BF00FFh","#DF01A5h","#FF00FFh","#FE2E64h","#B45F04h"};
GRAFFUERZA:=MAKEMAT(0,rowDim(M8),4);
FOR k FROM 1 TO rowDim(M8)DO GRAFFUERZA(k,1):=N(k,1);
GRAFFUERZA(k,2):=N(k+1,1);
GRAFFUERZA(k,3):=ESFUERZO(k,2);
GRAFFUERZA(k,4):=-ESFUERZO(k,5);
END;
MOMENTOSS:=MAKEMAT(0,rowDim(M8),4);
FOR k FROM 1 TO rowDim(M8)DO MOMENTOSS(k,1):=N(k,1);
MOMENTOSS(k,2):=N(k+1,1);
MOMENTOSS(k,3):=-ESFUERZO(k,3);
MOMENTOSS(k,4):=ESFUERZO(k,6);
END;
MAX_Y:=(ESFUERZO(-5));
MAX_Y:=TRN(MAX_Y);
rango:=maxnorm((MAX_Y));
MAX_Y:=(ESFUERZO(-2));
MAX_Y:=TRN(MAX_Y);
rango2:=maxnorm((MAX_Y));
IF rango2<rango THEN IF 8<rango THEN RANGO_Y:=rango/6.5;
ELSE IF 8<rango2 THEN RANGO_Y:=rango2/6.5;
ELSE RANGO_Y:=1;
END;
END;
ELSE IF 8<rango2 THEN RANGO_Y:=rango2/6.5;
ELSE IF 8<rango THEN RANGO_Y:=rango/6.5;
ELSE RANGO_Y:=1;
END;
END;
END;
ESFUERZOCER:=MAKEMAT(0,rowDim(M8),1);
LOCAL ECUAEZZF,ECUAMOM;
ECUAEZZF:=MAKEMAT(0,rowDim(GRAFFUERZA),3);
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO IF M8(k,6)≠ 0 AND M8(k,7)≠0 THEN IF M8(k,6)=M8(k,7)THEN ECUAEZZF(k,2):=M8(k,7);
ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
IF ABS(M8(k,6))<ABS(M8(k,7))THEN ECUAEZZF(k,1):=(M8(k,7)-M8(k,6))/(2*((lon(k,1))));
ECUAEZZF(k,2):=M8(k,6);
ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
IF ABS(M8(k,7))< ABS(M8(k,6))THEN ECUAEZZF(k,1):=(M8(k,7)-M8(k,6))/(2*((lon(k,1))));
ECUAEZZF(k,2):=M8(k,6);
ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
END;
IF M8(k,6)=0 AND M8(k,7)≠0 THEN ECUAEZZF(k,1):=(M8(k,7)-M8(k,6))/(2*((lon(k,1))));
ECUAEZZF(k,2):=M8(k,6);
ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
IF M8(k,6)≠ 0 AND M8(k,7)=0 THEN ECUAEZZF(k,1):=(M8(k,7)-M8(k,6))/(2*((lon(k,1))));
ECUAEZZF(k,2):=M8(k,6);
ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
IF M8(k,6)=0 AND M8(k,7)=0 THEN ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
END;
L0:={};
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO IF ECUAEZZF(k,1)=0 AND ECUAEZZF(k,2)=0 AND ECUAEZZF(k,3)≠ 0 THEN L0(k):=[0,0];
ELSE IF 0<ECUAEZZF(k,1)AND ECUAEZZF(k,2)=0 AND 0< ECUAEZZF(k,3)THEN L0(k):=[0,0];
ELSE IF ECUAEZZF(k,1)<0 AND ECUAEZZF(k,2)=0 AND ECUAEZZF(k,3)<0 THEN L0(k):=[0,0];
ELSE IF ECUAEZZF(k,1)=0 AND ECUAEZZF(k,2)<0 AND ECUAEZZF(k,3)< 0 THEN L0(k):=[0,0];
ELSE IF ECUAEZZF(k,1)=0 AND 0<ECUAEZZF(k,2)AND 0<ECUAEZZF(k,3)THEN L0(k):=[0,0];
ELSE L0(k):=proot(ECUAEZZF(k));
END;
END;
END;
END;
END;
END;
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO IF ECUAEZZF(k,1)≠0 AND ECUAEZZF(k,2)≠0 AND ECUAEZZF(k,3)≠0 THEN IF(ECUAEZZF(k,2)^2)-4*ECUAEZZF(k,1)*ECUAEZZF(k,3)<0.000000001 THEN L0(k):=[0,0];
END;
END;
END;
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO IF 0<L0(k,1)THEN ESFUERZOCER(k,1):=L0(k,1);
ELSE ESFUERZOCER(k,1):=L0(k,2);
END;
END;
LOCAL CORRECION;
CORRECION:=ESFUERZOCER;
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO IF lon(k,1)<CORRECION(k,1)THEN ESFUERZOCER(k,1):=0;
END;
END;
FOR k FROM 1 TO rowDim(ESFUERZOCER)DO IF ESFUERZOCER(k,1)≠0 THEN TEXTOUT(ROUND(N(k,1)+ESFUERZOCER(k,1),3),G1,-14+N(k,1)*(26/A)+ESFUERZOCER(k,1)*(26/A),-10.2,1,#0080FF,100);
END;
END;
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO dimencar:=(GRAFFUERZA(k,2)-GRAFFUERZA(k,1));
dimencar:=dimencar*5*(26/A);
IF M8(k,6)≠ 0 AND M8(k,7)≠0 THEN IF M8(k,6)=M8(k,7)THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,2)+M8(k,6)*((n*A/(5*26*2))))/RANGO_Y,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2,{EXPR(color(k)),200});
PIXON(G1,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,2)+M8(k,6)*((n*A/(5*26*2))))/RANGO_Y,EXPR(color(k)));
END;
END;
IF ABS(M8(k,6))<ABS(M8(k,7))THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,2)+M8(k,6)*((n*A/(5*26*2)))+((M8(k,7)-M8(k,6))*((n*A/(5*26*2))^2))/(2*((lon(k,1)))))/RANGO_Y,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2,{EXPR(color(k)),200});
PIXON(G1,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,2)+M8(k,6)*((n*A/(5*26*2)))+((M8(k,7)-M8(k,6))*((n*A/(5*26*2))^2))/(2*((lon(k,1)))))/RANGO_Y,EXPR(color(k)));
END;
END;
IF ABS(M8(k,7))< ABS(M8(k,6))THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,2)+M8(k,6)*((n*A/(5*26*2)))+((M8(k,7)-M8(k,6))*((n*A/(5*26*2))^2))/(2*((lon(k,1)))))/RANGO_Y,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2,{EXPR(color(k)),200});
PIXON(G1,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,2)+M8(k,6)*((n*A/(5*26*2)))+((M8(k,7)-M8(k,6))*((n*A/(5*26*2))^2))/(2*((lon(k,1)))))/RANGO_Y,EXPR(color(k)));
END;
END;
END;
IF M8(k,6)=0 AND M8(k,7)≠0 THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,2)+((M8(k,7)-M8(k,6))*((n*A/(5*26*2))^2))/(2*((lon(k,1)))))/RANGO_Y,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2,{EXPR(color(k)),200});
PIXON(G1,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,2)+((M8(k,7)-M8(k,6))*((n*A/(5*26*2))^2))/(2*((lon(k,1)))))/RANGO_Y,EXPR(color(k)));
END;
END;
IF M8(k,6)≠ 0 AND M8(k,7)=0 THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,2)-(M8(k,6)*((n*A/(5*26*2))^2)/(2*(lon(k,1))))+(M8(k,6)*(n*A/(5*26*2))))/RANGO_Y,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2,{EXPR(color(k)),200});
PIXON(G1,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,2)-(M8(k,6)*((n*A/(5*26*2))^2)/(2*(lon(k,1))))+(M8(k,6)*(n*A/(5*26*2))))/RANGO_Y,EXPR(color(k)));
END;
END;
IF M8(k,6)=0 AND M8(k,7)=0 THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,2))/RANGO_Y,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2,{EXPR(color(k)),200});
PIXON(G1,-13+0.1*n-0.1+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,2))/RANGO_Y,EXPR(color(k)));
END;
END;
END;
GRAFFUERZA:=ROUND(GRAFFUERZA,3);
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO IF GRAFFUERZA(k,3)<=0 THEN TEXTOUT(GRAFFUERZA(k,3),G1,-13+GRAFFUERZA(k,1)*(26/A),-2.2+GRAFFUERZA(k,3)/RANGO_Y,1,0,100);
LINE(G1,-13+GRAFFUERZA(k,1)*(26/A),-2,-13+GRAFFUERZA(k,1)*(26/A),-2+GRAFFUERZA(k,3)/RANGO_Y,EXPR(color(k)));
END;
IF GRAFFUERZA(k,3)>0 THEN TEXTOUT(GRAFFUERZA(k,3),G1,-13+GRAFFUERZA(k,1)*(26/A),-1.1+GRAFFUERZA(k,3)/RANGO_Y,1,0,100);
LINE(G1,-13+GRAFFUERZA(k,1)*(26/A),-2,-13+GRAFFUERZA(k,1)*(26/A),-2+GRAFFUERZA(k,3)/RANGO_Y,EXPR(color(k)));
END;
END;
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO IF GRAFFUERZA(k,4)<=0 THEN TEXTOUT(GRAFFUERZA(k,4),G1,-13+GRAFFUERZA(k,2)*(26/A),-2.2+GRAFFUERZA(k,4)/RANGO_Y,1,0,100);
LINE(G1,-13+GRAFFUERZA(k,2)*(26/A),-2,-13+GRAFFUERZA(k,2)*(26/A),-2+GRAFFUERZA(k,4)/RANGO_Y,EXPR(color(k)));
END;
IF GRAFFUERZA(k,4)>0 THEN TEXTOUT(GRAFFUERZA(k,4),G1,-13+GRAFFUERZA(k,2)*(26/A),-1.1+GRAFFUERZA(k,4)/RANGO_Y,1,0,100);
LINE(G1,-13+GRAFFUERZA(k,2)*(26/A),-2,-13+GRAFFUERZA(k,2)*(26/A),-2+GRAFFUERZA(k,4)/RANGO_Y,EXPR(color(k)));
END;
END;
LOCAL ECUAEZZF;
ECUAEZZF:=MAKEMAT(0,rowDim(GRAFFUERZA),3);
ECUAMOM:=MAKEMAT(0,rowDim(GRAFFUERZA),4);
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO IF M8(k,6)≠ 0 AND M8(k,7)≠0 THEN IF M8(k,6)=M8(k,7)THEN ECUAEZZF(k,2):=M8(k,7);
ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
IF ABS(M8(k,6))<ABS(M8(k,7))THEN ECUAEZZF(k,1):=(M8(k,7)-M8(k,6))/(2*((lon(k,1))));
ECUAEZZF(k,2):=M8(k,6);
ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
IF ABS(M8(k,7))< ABS(M8(k,6))THEN ECUAEZZF(k,1):=(M8(k,7)-M8(k,6))/(2*((lon(k,1))));
ECUAEZZF(k,2):=M8(k,6);
ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
END;
IF M8(k,6)=0 AND M8(k,7)≠0 THEN ECUAEZZF(k,1):=(M8(k,7)-M8(k,6))/(2*((lon(k,1))));
ECUAEZZF(k,2):=M8(k,6);
ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
IF M8(k,6)≠ 0 AND M8(k,7)=0 THEN ECUAEZZF(k,1):=(M8(k,7)-M8(k,6))/(2*((lon(k,1))));
ECUAEZZF(k,2):=M8(k,6);
ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
IF M8(k,6)=0 AND M8(k,7)=0 THEN ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
END;
ECUAEZZF:=ROUND(ECUAEZZF,3);
L7:={};
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO L7(k):=CAS.poly2symb(ECUAEZZF(k));
END;
END;
IF fmome=0 THEN ELSE LOCAL dimencar,n,rango2;
LOCAL MOMENTOSS,ESFUERZOCER,GRAFFUERZA;
GRAFFUERZA:=MAKEMAT(0,rowDim(M8),4);
FOR k FROM 1 TO rowDim(M8)DO GRAFFUERZA(k,1):=N(k,1);
GRAFFUERZA(k,2):=N(k+1,1);
GRAFFUERZA(k,3):=ESFUERZO(k,2);
GRAFFUERZA(k,4):=-ESFUERZO(k,5);
END;
MOMENTOSS:=MAKEMAT(0,rowDim(M8),4);
FOR k FROM 1 TO rowDim(M8)DO MOMENTOSS(k,1):=N(k,1);
MOMENTOSS(k,2):=N(k+1,1);
MOMENTOSS(k,3):=-ESFUERZO(k,3);
MOMENTOSS(k,4):=ESFUERZO(k,6);
END;
ESFUERZOCER:=MAKEMAT(0,rowDim(M8),1);
LOCAL ECUAEZZF,ECUAMOM;
ECUAEZZF:=MAKEMAT(0,rowDim(GRAFFUERZA),3);
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO IF M8(k,6)≠ 0 AND M8(k,7)≠0 THEN IF M8(k,6)=M8(k,7)THEN ECUAEZZF(k,2):=M8(k,7);
ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
IF ABS(M8(k,6))<ABS(M8(k,7))THEN ECUAEZZF(k,1):=(M8(k,7)-M8(k,6))/(2*((lon(k,1))));
ECUAEZZF(k,2):=M8(k,6);
ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
IF ABS(M8(k,7))< ABS(M8(k,6))THEN ECUAEZZF(k,1):=(M8(k,7)-M8(k,6))/(2*((lon(k,1))));
ECUAEZZF(k,2):=M8(k,6);
ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
END;
IF M8(k,6)=0 AND M8(k,7)≠0 THEN ECUAEZZF(k,1):=(M8(k,7)-M8(k,6))/(2*((lon(k,1))));
ECUAEZZF(k,2):=M8(k,6);
ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
IF M8(k,6)≠ 0 AND M8(k,7)=0 THEN ECUAEZZF(k,1):=(M8(k,7)-M8(k,6))/(2*((lon(k,1))));
ECUAEZZF(k,2):=M8(k,6);
ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
IF M8(k,6)=0 AND M8(k,7)=0 THEN ECUAEZZF(k,3):=ESFUERZO(k,2);
END;
END;
L0:={};
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO IF(ECUAEZZF(k,2)^2)-4*ECUAEZZF(k,1)*ECUAEZZF(k,3)<0 THEN L0(k):=[0,0];
ELSE IF ECUAEZZF(k,1)=0 AND ECUAEZZF(k,2)=0 AND ECUAEZZF(k,3)≠ 0 THEN L0(k):=[0,0];
ELSE IF 0<ECUAEZZF(k,1)AND ECUAEZZF(k,2)=0 AND 0< ECUAEZZF(k,3)THEN L0(k):=[0,0];
ELSE IF ECUAEZZF(k,1)<0 AND ECUAEZZF(k,2)=0 AND ECUAEZZF(k,3)<0 THEN L0(k):=[0,0];
ELSE IF ECUAEZZF(k,1)=0 AND ECUAEZZF(k,2)<0 AND ECUAEZZF(k,3)< 0 THEN L0(k):=[0,0];
ELSE IF ECUAEZZF(k,1)=0 AND 0<ECUAEZZF(k,2)AND 0<ECUAEZZF(k,3)THEN L0(k):=[0,0];
ELSE L0(k):=proot(ECUAEZZF(k));
END;
END;
END;
END;
END;
END;
END;
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO IF ECUAEZZF(k,1)≠0 AND ECUAEZZF(k,2)≠0 AND ECUAEZZF(k,3)≠0 THEN IF((ECUAEZZF(k,2)^2)-4*ECUAEZZF(k,1)*ECUAEZZF(k,3))<0.00000000001 THEN L0(k):=[0,0];
END;
END;
END;
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO IF 0<L0(k,1)THEN ESFUERZOCER(k,1):=L0(k,1);
ELSE ESFUERZOCER(k,1):=L0(k,2);
END;
END;
LOCAL CORRECION;
CORRECION:=ESFUERZOCER;
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO IF lon(k,1)<CORRECION(k,1)THEN ESFUERZOCER(k,1):=0;
END;
END;
LOCAL dimencar,n;
LOCAL MAX_Y,rango,rango2,RANGO_X,color1,momenmaxx,rango3;
LOCAL val2:=carg_ines,val1:=carg_punt,val3:=mon_fl;
color1:={"#DF01A5h","#B404AEh","#6A0888h","#4B088Ah","#3104B4h","#045FB4h","#01A9DBh","#01DFD7h","#04B431h","#74DF00h","#DBA901h","#DF3A01h","#FF0040h","#FF0080h","#DF01A5h","#DF0060h"};
momenmaxx:=MAKEMAT(0,rowDim(ESFUERZOCER),1);
FOR k FROM 1 TO rowDim(ESFUERZOCER)DO IF 0<ESFUERZOCER(k,1)THEN IF M8(k,6)≠ 0 AND M8(k,7)≠0 THEN IF M8(k,6)=M8(k,7)THEN momenmaxx(k,1):=ROUND(-((ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)-M8(k,6)*(ESFUERZOCER(k,1))*(ESFUERZOCER(k,1)/2))),4);
END;
IF ABS(M8(k,7))<ABS(M8(k,6))THEN momenmaxx(k,1):=ROUND(-((ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))),4);
END;
IF ABS(M8(k,6))<ABS(M8(k,7))THEN momenmaxx(k,1):=ROUND(-((ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))),4);
END;
END;
IF M8(k,6)≠ 0 AND M8(k,7)=0 THEN momenmaxx(k,1):=ROUND(-((ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))),4);
END;
IF M8(k,6)=0 AND M8(k,7)≠0 THEN momenmaxx(k,1):=ROUND(-((ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))),4);
END;
END;
END;
MAX_Y:=(momenmaxx(-1));
MAX_Y:=TRN(MAX_Y);
rango3:=maxnorm((MAX_Y));
MAX_Y:=(ESFUERZO(-6));
MAX_Y:=TRN(MAX_Y);
rango:=maxnorm((MAX_Y));
MAX_Y:=(ESFUERZO(-3));
MAX_Y:=TRN(MAX_Y);
rango2:=maxnorm((MAX_Y));
IF rango<rango3 AND rango2<rango3 THEN RANGO_X:=rango3/6.5;
ELSE IF rango2<rango THEN IF 8<rango THEN RANGO_X:=rango/6.5;
ELSE IF 8<rango2 THEN RANGO_X:=rango2/6.5;
ELSE RANGO_X:=1;
END;
END;
ELSE IF 8<rango2 THEN RANGO_X:=rango2/6.5;
ELSE IF 8<rango THEN RANGO_X:=rango/6.5;
ELSE RANGO_X:=1;
END;
END;
END;
END;
IF rango=0 AND rango2=0 THEN RANGO_X:=8*RANGO_X*(A/26);
END;
FOR k FROM 1 TO rowDim(ESFUERZOCER)DO IF ESFUERZOCER(k,1)≠0 THEN TEXTOUT(ROUND(N(k,1)+ESFUERZOCER(k,1),3),G1,-14+N(k,1)*(26/A)+ESFUERZOCER(k,1)*(26/A),-10.2,1,#0080FF,100);
END;
END;
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO dimencar:=(GRAFFUERZA(k,2)-GRAFFUERZA(k,1));
dimencar:=dimencar*5*(26/A);
IF M8(k,6)≠ 0 AND M8(k,7)≠0 THEN IF M8(k,6)=M8(k,7)THEN FOR n FROM 1 TO 2*dimencar+0.5 DO RECT(G1,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,3)-ESFUERZO(k,2)*(n*A/(5*26*2))-M8(k,6)*((n*A/(5*26*2)))*((n*A/(5*26*2))/2))/RANGO_X,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2,{EXPR(color1(k)),200});
PIXON(G1,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,3)-ESFUERZO(k,2)*(n*A/(5*26*2))-M8(k,6)*((n*A/(5*26*2)))*((n*A/(5*26*2))/2))/RANGO_X,EXPR(color1(k)));
END;
END;
IF ABS(M8(k,7))< ABS(M8(k,6))THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,3)-ESFUERZO(k,2)*(n*A/(5*26*2))+(M8(k,6)*((n*A/(5*26*2))^3)/(6*(lon(k,1))))-(M8(k,7)*((n*A/(5*26*2))^3)/(6*(lon(k,1))))-(M8(k,6)*((n*A/(5*26*2))^2)/2))/RANGO_X,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2,{EXPR(color1(k)),200});
PIXON(G1,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,3)-ESFUERZO(k,2)*(n*A/(5*26*2))+(M8(k,6)*((n*A/(5*26*2))^3)/(6*(lon(k,1))))-(M8(k,7)*((n*A/(5*26*2))^3)/(6*(lon(k,1))))-(M8(k,6)*((n*A/(5*26*2))^2)/2))/RANGO_X,EXPR(color1(k)));
END;
END;
IF ABS(M8(k,6))<ABS(M8(k,7))THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,3)-ESFUERZO(k,2)*(n*A/(5*26*2))+(M8(k,6)*((n*A/(5*26*2))^3)/(6*(lon(k,1))))-(M8(k,7)*((n*A/(5*26*2))^3)/(6*(lon(k,1))))-(M8(k,6)*((n*A/(5*26*2))^2)/2))/RANGO_X,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2,{EXPR(color1(k)),200});
PIXON(G1,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,3)-ESFUERZO(k,2)*(n*A/(5*26*2))+(M8(k,6)*((n*A/(5*26*2))^3)/(6*(lon(k,1))))-(M8(k,7)*((n*A/(5*26*2))^3)/(6*(lon(k,1))))-(M8(k,6)*((n*A/(5*26*2))^2)/2))/RANGO_X,EXPR(color1(k)));
END;
END;
END;
IF M8(k,6)≠ 0 AND M8(k,7)=0 THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,3)-ESFUERZO(k,2)*(n*A/(5*26*2))+(M8(k,6)*((n*A/(5*26*2))^3)/(6*(lon(k,1))))-(M8(k,6)*((n*A/(5*26*2))^2)/2))/RANGO_X,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2,{EXPR(color1(k)),200});
PIXON(G1,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,3)-ESFUERZO(k,2)*(n*A/(5*26*2))+(M8(k,6)*((n*A/(5*26*2))^3)/(6*(lon(k,1))))-(M8(k,6)*((n*A/(5*26*2))^2)/2))/RANGO_X,EXPR(color1(k)));
END;
END;
IF M8(k,6)=0 AND M8(k,7)≠0 THEN FOR n FROM 1 TO 2*dimencar DO RECT(G1,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,3)-ESFUERZO(k,2)*(n*A/(5*26*2))+(M8(k,6)*((n*A/(5*26*2))^3)/(6*(lon(k,1))))-(M8(k,7)*((n*A/(5*26*2))^3)/(6*(lon(k,1))))-(M8(k,6)*((n*A/(5*26*2))^2)/2))/RANGO_X,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2,{EXPR(color1(k)),200});
PIXON(G1,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,3)-ESFUERZO(k,2)*(n*A/(5*26*2))+(M8(k,6)*((n*A/(5*26*2))^3)/(6*(lon(k,1))))-(M8(k,7)*((n*A/(5*26*2))^3)/(6*(lon(k,1))))-(M8(k,6)*((n*A/(5*26*2))^2)/2))/RANGO_X,EXPR(color1(k)));
END;
END;
IF M8(k,6)=0 AND M8(k,7)=0 THEN FOR n FROM 1 TO 2*dimencar+0.5 DO RECT(G1,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,3)-ESFUERZO(k,2)*(n*A/(5*26*2)))/RANGO_X,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2,{EXPR(color1(k)),200});
PIXON(G1,-13+0.1*n+GRAFFUERZA(k,1)*(26/A),-2+(ESFUERZO(k,3)-ESFUERZO(k,2)*(n*A/(5*26*2)))/RANGO_X,EXPR(color1(k)));
END;
END;
END;
FOR k FROM 1 TO rowDim(ESFUERZOCER)DO IF M8(k,6)≠ 0 AND M8(k,7)≠0 THEN IF M8(k,6)=M8(k,7)THEN IF MOMENTOSS(k,3)<=0 THEN TEXTOUT(ROUND(-((ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)-M8(k,6)*(ESFUERZOCER(k,1))*(ESFUERZOCER(k,1)/2))),3),G1,-13+N(k,1)*(26/A)+ESFUERZOCER(k,1)*(26/A),-2.2+(ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)-M8(k,6)*(ESFUERZOCER(k,1))*(ESFUERZOCER(k,1)/2))/RANGO_X,1,#FF0040,100);
END;
IF MOMENTOSS(k,3)>0 THEN TEXTOUT(ROUND(-((ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)-M8(k,6)*(ESFUERZOCER(k,1))*(ESFUERZOCER(k,1)/2))),3),G1,-13+N(k,1)*(26/A)+ESFUERZOCER(k,1)*(26/A),-1.1+(ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)-M8(k,6)*(ESFUERZOCER(k,1))*(ESFUERZOCER(k,1)/2))/RANGO_X,1,#FF0040,100);
END;
END;
IF ABS(M8(k,7))<ABS(M8(k,6))THEN IF MOMENTOSS(k,3)<=0 THEN TEXTOUT(ROUND(-((ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))),3),G1,-13+N(k,1)*(26/A)+ESFUERZOCER(k,1)*(26/A),-2.2+(ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))/RANGO_X,1,#FF0040,100);
END;
IF MOMENTOSS(k,3)>0 THEN TEXTOUT(ROUND(-((ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))),3),G1,-13+N(k,1)*(26/A)+ESFUERZOCER(k,1)*(26/A),-1.1+(ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))/RANGO_X,1,#FF0040,100);
END;
END;
IF ABS(M8(k,6))<ABS(M8(k,7))THEN IF MOMENTOSS(k,3)<=0 THEN TEXTOUT(ROUND(-((ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))),3),G1,-13+N(k,1)*(26/A)+ESFUERZOCER(k,1)*(26/A),-2.2+(ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))/RANGO_X,1,#FF0040,100);
END;
IF MOMENTOSS(k,3)>0 THEN TEXTOUT(ROUND(-((ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))),3),G1,-13+N(k,1)*(26/A)+ESFUERZOCER(k,1)*(26/A),-1.1+(ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))/RANGO_X,1,#FF0040,100);
END;
END;
END;
IF M8(k,6)≠ 0 AND M8(k,7)=0 THEN IF MOMENTOSS(k,3)<=0 THEN TEXTOUT(ROUND(-((ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))),3),G1,-13+N(k,1)*(26/A)+ESFUERZOCER(k,1)*(26/A),-2.2+(ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))/RANGO_X,1,#FF0040,100);
END;
IF MOMENTOSS(k,3)>0 THEN TEXTOUT(ROUND(-((ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))),3),G1,-13+N(k,1)*(26/A)+ESFUERZOCER(k,1)*(26/A),-1.1+(ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))/RANGO_X,1,#FF0040,100);
END;
END;
IF M8(k,6)=0 AND M8(k,7)≠0 THEN IF MOMENTOSS(k,3)<=0 THEN TEXTOUT(ROUND(-((ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))),3),G1,-13+N(k,1)*(26/A)+ESFUERZOCER(k,1)*(26/A),-2.2+(ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))/RANGO_X,1,#FF0040,100);
END;
IF MOMENTOSS(k,3)>0 THEN TEXTOUT(ROUND(-((ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))),3),G1,-13+N(k,1)*(26/A)+ESFUERZOCER(k,1)*(26/A),-1.1+(ESFUERZO(k,3)-ESFUERZO(k,2)*ESFUERZOCER(k,1)+(M8(k,6)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,7)*(ESFUERZOCER(k,1)^3)/(6*(lon(k,1))))-(M8(k,6)*(ESFUERZOCER(k,1)^2)/2))/RANGO_X,1,#FF0040,100);
END;
END;
END;
MOMENTOSS:=ROUND(MOMENTOSS,3);
FOR k FROM 1 TO rowDim(MOMENTOSS)DO IF MOMENTOSS(k,3)>0 THEN TEXTOUT(MOMENTOSS(k,3),G1,-13+MOMENTOSS(k,1)*(26/A),-2.2-MOMENTOSS(k,3)/RANGO_X,1,0,100);
LINE(G1,-13+MOMENTOSS(k,1)*(26/A),-2,-13+MOMENTOSS(k,1)*(26/A),-2-MOMENTOSS(k,3)/RANGO_X,EXPR(color1(k)));
END;
IF MOMENTOSS(k,3)<=0 THEN TEXTOUT(MOMENTOSS(k,3),G1,-13+MOMENTOSS(k,1)*(26/A),-1.1-MOMENTOSS(k,3)/RANGO_X,1,0,100);
LINE(G1,-13+MOMENTOSS(k,1)*(26/A),-2,-13+MOMENTOSS(k,1)*(26/A),-2-MOMENTOSS(k,3)/RANGO_X,EXPR(color1(k)));
END;
END;
FOR k FROM 1 TO rowDim(MOMENTOSS)DO IF MOMENTOSS(k,4)>0 THEN TEXTOUT(MOMENTOSS(k,4),G1,-13+MOMENTOSS(k,2)*(26/A),-2.2-MOMENTOSS(k,4)/RANGO_X,1,0,100);
LINE(G1,-13+MOMENTOSS(k,2)*(26/A),-2,-13+MOMENTOSS(k,2)*(26/A),-2-MOMENTOSS(k,4)/RANGO_X,EXPR(color1(k)));
END;
IF MOMENTOSS(k,4)<=0 THEN TEXTOUT(MOMENTOSS(k,4),G1,-13+MOMENTOSS(k,2)*(26/A),-1.1-MOMENTOSS(k,4)/RANGO_X,1,0,100);
LINE(G1,-13+MOMENTOSS(k,2)*(26/A),-2,-13+MOMENTOSS(k,2)*(26/A),-2-MOMENTOSS(k,4)/RANGO_X,EXPR(color1(k)));
END;
END;
LOCAL ECUAMOM;
ECUAMOM:=MAKEMAT(0,rowDim(GRAFFUERZA),4);
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO IF M8(k,6)≠ 0 AND M8(k,7)≠0 THEN IF M8(k,6)=M8(k,7)THEN ECUAMOM(k,2):=-M8(k,6)/2;
ECUAMOM(k,3):=-ESFUERZO(k,2);
ECUAMOM(k,4):=ESFUERZO(k,3);
END;
IF ABS(M8(k,6))<ABS(M8(k,7))THEN ECUAMOM(k,1):=-(M8(k,7)-M8(k,6))/(6*((lon(k,1))));
ECUAMOM(k,2):=-M8(k,6)/2;
ECUAMOM(k,3):=-ESFUERZO(k,2);
ECUAMOM(k,4):=ESFUERZO(k,3);
END;
IF ABS(M8(k,7))< ABS(M8(k,6))THEN ECUAMOM(k,1):=-(M8(k,7)-M8(k,6))/(6*((lon(k,1))));
ECUAMOM(k,2):=-M8(k,6)/2;
ECUAMOM(k,3):=-ESFUERZO(k,2);
ECUAMOM(k,4):=ESFUERZO(k,3);
END;
END;
IF M8(k,6)=0 AND M8(k,7)≠0 THEN ECUAMOM(k,1):=-(M8(k,7)-M8(k,6))/(6*((lon(k,1))));
ECUAMOM(k,2):=-M8(k,6)/2;
ECUAMOM(k,3):=-ESFUERZO(k,2);
ECUAMOM(k,4):=ESFUERZO(k,3);
END;
IF M8(k,6)≠ 0 AND M8(k,7)=0 THEN ECUAMOM(k,1):=-(M8(k,7)-M8(k,6))/(6*((lon(k,1))));
ECUAMOM(k,2):=-M8(k,6)/2;
ECUAMOM(k,3):=-ESFUERZO(k,2);
ECUAMOM(k,4):=ESFUERZO(k,3);
END;
IF M8(k,6)=0 AND M8(k,7)=0 THEN ECUAMOM(k,3):=-ESFUERZO(k,2);
ECUAMOM(k,4):=ESFUERZO(k,3);
END;
END;
ECUAMOM:=ROUND(ECUAMOM,5);
L8:={};
FOR k FROM 1 TO rowDim(GRAFFUERZA)DO L8(k):=-CAS.poly2symb(ECUAMOM(k));
END;
LOCAL LIDDDB;
LIDDDB:={"B-1","B-2","B-3","B-4","B-5","B-6","B-7","B-8","B-9","B-10","B-11","B-12","B-13","B-14","B-15","B-16","B-17","B-18","B-19","B-20"};
END;
END;
opn_datvp BEGIN BLIT(G1);
RECT_P(0,22,320,240,{#1C1C1C,200});
RECT_P(60,80,270,150,0,{#1C1C1C,50});
TEXTOUT_P("OPEN DATA",135,105,2,#FFFFFF);
RECT_P(90,123,240,125,0);
for k:=1 to 30 do RECT_P(90,123,90+5*k,125,#40FF00);
wait(0.02);
end;
IF dataVP(27)=1 THEN dataVP_C(1):=fileVP(1);
dataVP(27):=fileVP(6);
dataVP(1):=fileVP(11);
dataVP(15):=fileVP(16);
dataVP(16):=fileVP(21);
dataVP(17):=fileVP(26);
dataVP(18):=fileVP(31);
dataVP(19):=fileVP(36);
END;
IF dataVP(27)=2 THEN dataVP_C(1):=fileVP(2);
dataVP(27):=fileVP(7);
dataVP(1):=fileVP(12);
dataVP(15):=fileVP(17);
dataVP(16):=fileVP(22);
dataVP(17):=fileVP(27);
dataVP(18):=fileVP(32);
dataVP(19):=fileVP(37);
END;
IF dataVP(27)=3 THEN dataVP_C(1):=fileVP(3);
dataVP(27):=fileVP(8);
dataVP(1):=fileVP(13);
dataVP(15):=fileVP(18);
dataVP(16):=fileVP(23);
dataVP(17):=fileVP(28);
dataVP(18):=fileVP(33);
dataVP(19):=fileVP(38);
END;
IF dataVP(27)=4 THEN dataVP_C(1):=fileVP(4);
dataVP(27):=fileVP(9);
dataVP(1):=fileVP(14);
dataVP(15):=fileVP(19);
dataVP(16):=fileVP(24);
dataVP(17):=fileVP(29);
dataVP(18):=fileVP(34);
dataVP(19):=fileVP(39);
END;
IF dataVP(27)=5 THEN dataVP_C(1):=fileVP(5);
dataVP(27):=fileVP(10);
dataVP(1):=fileVP(15);
dataVP(15):=fileVP(20);
dataVP(16):=fileVP(25);
dataVP(17):=fileVP(30);
dataVP(18):=fileVP(35);
dataVP(19):=fileVP(40);
END;
RECT_P(60,80,270,150,0,#1C1C1C);
TEXTOUT_P("success loading",130,110,2,#FFFFFF);
TEXTOUT_P("✔",100,100,7,#40FF00);
wait(1.2);
BLIT_P(G1,250,8,320,21,G1,0,8,70,21);
TEXTOUT_P(dataVP_C(1),G1,250,10,1,#00FF00);
diag_gen();
BLIT(G1);
MOUSE1();
END;
